2019-05-20 09:38:21,156 (MainThread): Tracking: tracking
2019-05-20 09:38:21,158 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cb9150410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cb9150e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cb9150a90>], 'label': 'start'}
2019-05-20 09:38:21,423 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cbb829210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cbc91b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cbf07d350>], 'label': 'end'}
2019-05-20 09:38:21,663 (MainThread): Flushing usage events
2019-05-20 09:38:41,523 (MainThread): Tracking: tracking
2019-05-20 09:38:41,524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5acb1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5acb1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5acb1810>], 'label': 'start'}
2019-05-20 09:38:41,817 (MainThread): Parsing macros/adapters.sql
2019-05-20 09:38:41,843 (MainThread): Parsing macros/catalog.sql
2019-05-20 09:38:41,850 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 09:38:41,854 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 09:38:41,880 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 09:38:41,889 (MainThread): Parsing macros/core.sql
2019-05-20 09:38:41,898 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 09:38:41,963 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 09:38:41,980 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 09:38:41,985 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 09:38:41,989 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 09:38:42,004 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 09:38:42,050 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 09:38:42,059 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 09:38:42,078 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 09:38:42,110 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 09:38:42,127 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 09:38:42,141 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 09:38:42,156 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 09:38:42,160 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 09:38:42,163 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 09:38:42,166 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 09:38:42,191 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 09:38:42,238 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.gdelt.example

2019-05-20 09:38:42,282 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 1 models
2019-05-20 09:38:42,283 (MainThread): 
2019-05-20 09:38:42,284 (MainThread): 09:38:42 | Concurrency: 1 threads (target='dev')
2019-05-20 09:38:42,284 (MainThread): 09:38:42 | 
2019-05-20 09:38:42,288 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 09:38:42,296 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 09:38:42,413 (MainThread): 09:38:42 | Done.
2019-05-20 09:38:42,414 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5a7c0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6314b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5a7f8050>], 'label': 'end'}
2019-05-20 09:38:42,658 (MainThread): Flushing usage events
2019-05-20 09:42:05,275 (MainThread): Tracking: tracking
2019-05-20 09:42:05,276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8d031690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8d031a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8d031810>], 'label': 'start'}
2019-05-20 09:42:05,532 (MainThread): Parsing macros/adapters.sql
2019-05-20 09:42:05,560 (MainThread): Parsing macros/catalog.sql
2019-05-20 09:42:05,566 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 09:42:05,569 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 09:42:05,589 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 09:42:05,596 (MainThread): Parsing macros/core.sql
2019-05-20 09:42:05,605 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 09:42:05,670 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 09:42:05,686 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 09:42:05,692 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 09:42:05,696 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 09:42:05,711 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 09:42:05,756 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 09:42:05,765 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 09:42:05,785 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 09:42:05,816 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 09:42:05,833 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 09:42:05,847 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 09:42:05,862 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 09:42:05,866 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 09:42:05,869 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 09:42:05,872 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 09:42:05,896 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 09:42:05,943 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.gdelt.example

2019-05-20 09:42:05,978 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 1 models
2019-05-20 09:42:05,980 (MainThread): 
2019-05-20 09:42:06,007 (MainThread): Parsing macros/adapters.sql
2019-05-20 09:42:06,025 (MainThread): Parsing macros/catalog.sql
2019-05-20 09:42:06,030 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 09:42:06,033 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 09:42:06,053 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 09:42:06,060 (MainThread): Parsing macros/core.sql
2019-05-20 09:42:06,069 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 09:42:06,190 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 09:42:06,206 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 09:42:06,212 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 09:42:06,216 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 09:42:06,231 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 09:42:06,275 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 09:42:06,284 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 09:42:06,303 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 09:42:06,335 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 09:42:06,352 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 09:42:06,367 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 09:42:06,381 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 09:42:06,385 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 09:42:06,388 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 09:42:06,392 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 09:42:06,582 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-20 09:42:06,583 (MainThread): Opening a new connection, currently in state init
2019-05-20 09:42:12,801 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 09:42:12,802 (MainThread): On list_relations_without_caching: BEGIN
2019-05-20 09:42:12,963 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-20 09:42:12,965 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 09:42:12,965 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-20 09:42:16,474 (MainThread): SQL status: SUCCESS 56 in 3.51 seconds
2019-05-20 09:42:16,514 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-20 09:42:17,111 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-20 09:42:17,111 (MainThread): Re-using an available connection from the pool.
2019-05-20 09:42:17,112 (MainThread): Using snowflake connection "list_schemas".
2019-05-20 09:42:17,112 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-20 09:42:18,745 (MainThread): SQL status: SUCCESS 2 in 1.63 seconds
2019-05-20 09:42:18,748 (MainThread): 09:42:18 | Concurrency: 1 threads (target='dev')
2019-05-20 09:42:18,749 (MainThread): 09:42:18 | 
2019-05-20 09:42:18,755 (Thread-1): 09:42:18 | 1 of 1 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-20 09:42:18,758 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 09:42:18,779 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 09:42:18,922 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 09:42:18,946 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-20 09:42:18,947 (Thread-1): Re-using an available connection from the pool.
2019-05-20 09:42:18,950 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 09:42:18,950 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-20 09:42:19,201 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2019-05-20 09:42:19,202 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 09:42:19,202 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-20 09:42:19,800 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2019-05-20 09:42:19,808 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 09:42:19,809 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 09:42:19,809 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 09:42:19,956 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-20 09:42:19,978 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8ba8f750>], 'label': '3aef11d4-53aa-4c18-80a6-d6b2ee9a53df'}
2019-05-20 09:42:20,169 (Thread-1): 09:42:20 | 1 of 1 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 1.22s]
2019-05-20 09:42:20,276 (MainThread): 09:42:20 | 
2019-05-20 09:42:20,277 (MainThread): 09:42:20 | Finished running 1 view models in 14.30s.
2019-05-20 09:42:20,634 (MainThread): 
2019-05-20 09:42:20,635 (MainThread): Completed successfully
2019-05-20 09:42:20,638 (MainThread): 
Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2019-05-20 09:42:20,643 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8d050bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8d06e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea946f7d90>], 'label': 'end'}
2019-05-20 09:42:20,871 (MainThread): Flushing usage events
2019-05-20 09:51:46,552 (MainThread): Tracking: tracking
2019-05-20 09:51:46,555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49903f0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49903f0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49903f04d0>], 'label': 'start'}
2019-05-20 09:51:46,723 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4993bbb690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f499222ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4992ac9210>], 'label': 'end'}
2019-05-20 09:51:47,429 (MainThread): Flushing usage events
2019-05-20 09:52:09,945 (MainThread): Tracking: tracking
2019-05-20 09:52:09,946 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4e1d0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4e1d0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4e1d07d0>], 'label': 'start'}
2019-05-20 09:52:10,202 (MainThread): Parsing macros/adapters.sql
2019-05-20 09:52:10,221 (MainThread): Parsing macros/catalog.sql
2019-05-20 09:52:10,227 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 09:52:10,231 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 09:52:10,252 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 09:52:10,260 (MainThread): Parsing macros/core.sql
2019-05-20 09:52:10,268 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 09:52:10,306 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 09:52:10,316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 09:52:10,320 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 09:52:10,322 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 09:52:10,332 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 09:52:10,359 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 09:52:10,364 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 09:52:10,376 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 09:52:10,405 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 09:52:10,420 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 09:52:10,430 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 09:52:10,441 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 09:52:10,444 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 09:52:10,446 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 09:52:10,448 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 09:52:10,466 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 09:52:10,526 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 1 models
2019-05-20 09:52:10,527 (MainThread): 
2019-05-20 09:52:10,528 (MainThread): 09:52:10 | Concurrency: 1 threads (target='dev')
2019-05-20 09:52:10,528 (MainThread): 09:52:10 | 
2019-05-20 09:52:10,531 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 09:52:10,536 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 09:52:10,644 (MainThread): 09:52:10 | Done.
2019-05-20 09:52:10,644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4dce1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56d09210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4dd19350>], 'label': 'end'}
2019-05-20 09:52:10,780 (MainThread): Flushing usage events
2019-05-20 09:52:47,998 (MainThread): Tracking: tracking
2019-05-20 09:52:47,998 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84a4f0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84a4f0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84a4f07d0>], 'label': 'start'}
2019-05-20 09:52:48,242 (MainThread): Parsing macros/adapters.sql
2019-05-20 09:52:48,271 (MainThread): Parsing macros/catalog.sql
2019-05-20 09:52:48,276 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 09:52:48,279 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 09:52:48,300 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 09:52:48,308 (MainThread): Parsing macros/core.sql
2019-05-20 09:52:48,318 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 09:52:48,386 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 09:52:48,402 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 09:52:48,407 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 09:52:48,412 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 09:52:48,429 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 09:52:48,474 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 09:52:48,482 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 09:52:48,502 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 09:52:48,534 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 09:52:48,552 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 09:52:48,566 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 09:52:48,578 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 09:52:48,582 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 09:52:48,585 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 09:52:48,588 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 09:52:48,613 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 09:52:48,696 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 1 models
2019-05-20 09:52:48,697 (MainThread): 
2019-05-20 09:52:48,725 (MainThread): Parsing macros/adapters.sql
2019-05-20 09:52:48,743 (MainThread): Parsing macros/catalog.sql
2019-05-20 09:52:48,750 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 09:52:48,753 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 09:52:48,773 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 09:52:48,781 (MainThread): Parsing macros/core.sql
2019-05-20 09:52:48,790 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 09:52:48,900 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 09:52:48,914 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 09:52:48,919 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 09:52:48,922 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 09:52:48,938 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 09:52:48,986 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 09:52:48,993 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 09:52:49,008 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 09:52:49,041 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 09:52:49,053 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 09:52:49,064 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 09:52:49,076 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 09:52:49,081 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 09:52:49,085 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 09:52:49,088 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 09:52:49,306 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-20 09:52:49,307 (MainThread): Opening a new connection, currently in state init
2019-05-20 09:52:52,817 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 09:52:52,818 (MainThread): On list_relations_without_caching: BEGIN
2019-05-20 09:52:53,124 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2019-05-20 09:52:53,125 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 09:52:53,125 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-20 09:53:28,431 (MainThread): SQL status: SUCCESS 57 in 35.31 seconds
2019-05-20 09:53:28,456 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-20 09:53:29,029 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-20 09:53:29,030 (MainThread): Re-using an available connection from the pool.
2019-05-20 09:53:29,031 (MainThread): Using snowflake connection "list_schemas".
2019-05-20 09:53:29,031 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-20 09:53:33,022 (MainThread): SQL status: SUCCESS 2 in 3.99 seconds
2019-05-20 09:53:33,024 (MainThread): 09:53:33 | Concurrency: 1 threads (target='dev')
2019-05-20 09:53:33,025 (MainThread): 09:53:33 | 
2019-05-20 09:53:33,029 (Thread-1): 09:53:33 | 1 of 1 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-20 09:53:33,030 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 09:53:33,044 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 09:53:33,181 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 09:53:33,186 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-20 09:53:33,187 (Thread-1): Re-using an available connection from the pool.
2019-05-20 09:53:33,188 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 09:53:33,189 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-20 09:53:33,377 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-20 09:53:33,378 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 09:53:33,379 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-20 09:53:34,280 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2019-05-20 09:53:34,284 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 09:53:34,285 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 09:53:34,285 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 09:53:34,423 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-20 09:53:34,437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb848042e90>], 'label': '9e098b0e-4955-48fe-bcca-659889e5bdb9'}
2019-05-20 09:53:34,691 (Thread-1): 09:53:34 | 1 of 1 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 1.41s]
2019-05-20 09:53:34,751 (MainThread): 09:53:34 | 
2019-05-20 09:53:34,752 (MainThread): 09:53:34 | Finished running 1 view models in 46.05s.
2019-05-20 09:53:35,227 (MainThread): 
2019-05-20 09:53:35,227 (MainThread): Completed successfully
2019-05-20 09:53:35,228 (MainThread): 
Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2019-05-20 09:53:35,229 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84a50ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84a52e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8488c8ed0>], 'label': 'end'}
2019-05-20 09:53:35,462 (MainThread): Flushing usage events
2019-05-20 12:31:24,164 (MainThread): Tracking: tracking
2019-05-20 12:31:24,170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50fbb50350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50fbb50510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50fbb504d0>], 'label': 'start'}
2019-05-20 12:31:24,511 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ff31b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50fd98ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50fe229210>], 'label': 'end'}
2019-05-20 12:31:24,686 (MainThread): Flushing usage events
2019-05-20 12:32:02,616 (MainThread): Tracking: tracking
2019-05-20 12:32:02,617 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91990650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee91990a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee919907d0>], 'label': 'start'}
2019-05-20 12:32:03,123 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:32:03,161 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:32:03,181 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:32:03,200 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:32:03,238 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:32:03,264 (MainThread): Parsing macros/core.sql
2019-05-20 12:32:03,294 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:32:03,384 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:32:03,412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:32:03,428 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:32:03,446 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:32:03,480 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:32:03,545 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:32:03,569 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:32:03,609 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:32:03,661 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:32:03,695 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:32:03,727 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:32:03,756 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:32:03,773 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:32:03,789 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:32:03,803 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:32:03,836 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:32:03,853 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:32:03,861 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:32:03,970 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 3 models
2019-05-20 12:32:03,973 (MainThread): 
2019-05-20 12:32:03,974 (MainThread): 12:32:03 | Concurrency: 1 threads (target='dev')
2019-05-20 12:32:03,974 (MainThread): 12:32:03 | 
2019-05-20 12:32:03,980 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:32:03,995 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:32:04,013 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:32:04,031 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:32:04,119 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:32:04,135 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:32:04,251 (MainThread): 12:32:04 | Done.
2019-05-20 12:32:04,253 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee9a4c9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee97dfcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee97dfcf10>], 'label': 'end'}
2019-05-20 12:32:04,514 (MainThread): Flushing usage events
2019-05-20 12:33:02,343 (MainThread): Tracking: tracking
2019-05-20 12:33:02,344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534c330650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534c330a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534c3307d0>], 'label': 'start'}
2019-05-20 12:33:02,675 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:33:02,701 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:33:02,708 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:33:02,712 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:33:02,733 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:33:02,740 (MainThread): Parsing macros/core.sql
2019-05-20 12:33:02,748 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:33:02,812 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:33:02,828 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:33:02,833 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:33:02,837 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:33:02,852 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:33:02,896 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:33:02,905 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:33:02,926 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:33:02,956 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:33:02,973 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:33:02,987 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:33:03,001 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:33:03,005 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:33:03,008 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:33:03,011 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:33:03,037 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:33:03,054 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:33:03,062 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:33:03,136 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 3 models
2019-05-20 12:33:03,139 (MainThread): 
2019-05-20 12:33:03,225 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:33:03,242 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:33:03,247 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:33:03,250 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:33:03,269 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:33:03,275 (MainThread): Parsing macros/core.sql
2019-05-20 12:33:03,284 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:33:03,346 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:33:03,362 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:33:03,367 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:33:03,371 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:33:03,386 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:33:03,430 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:33:03,438 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:33:03,457 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:33:03,488 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:33:03,504 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:33:03,518 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:33:03,532 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:33:03,536 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:33:03,539 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:33:03,542 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:33:03,731 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-20 12:33:03,732 (MainThread): Opening a new connection, currently in state init
2019-05-20 12:33:09,502 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:33:09,503 (MainThread): On list_relations_without_caching: BEGIN
2019-05-20 12:33:09,705 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2019-05-20 12:33:09,706 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:33:09,707 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-20 12:33:12,091 (MainThread): SQL status: SUCCESS 56 in 2.38 seconds
2019-05-20 12:33:12,152 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-20 12:33:13,008 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-20 12:33:13,009 (MainThread): Re-using an available connection from the pool.
2019-05-20 12:33:13,009 (MainThread): Using snowflake connection "list_schemas".
2019-05-20 12:33:13,009 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-20 12:33:15,234 (MainThread): SQL status: SUCCESS 2 in 2.22 seconds
2019-05-20 12:33:15,236 (MainThread): 12:33:15 | Concurrency: 1 threads (target='dev')
2019-05-20 12:33:15,238 (MainThread): 12:33:15 | 
2019-05-20 12:33:15,244 (Thread-1): 12:33:15 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-20 12:33:15,245 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:33:15,257 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:33:15,357 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:33:15,369 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-20 12:33:15,370 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:33:15,371 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:33:15,371 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-20 12:33:15,856 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2019-05-20 12:33:15,857 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:33:15,857 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-20 12:33:17,005 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2019-05-20 12:33:17,010 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:33:17,011 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:33:17,011 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:33:17,184 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-20 12:33:17,204 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534a719b50>], 'label': '03cc674a-ab94-4fbb-8a74-31b1df7f271b'}
2019-05-20 12:33:17,433 (Thread-1): 12:33:17 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 1.96s]
2019-05-20 12:33:17,436 (Thread-1): 12:33:17 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-20 12:33:17,438 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:33:17,458 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:33:17,476 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:33:17,489 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-20 12:33:17,490 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:33:17,491 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:33:17,491 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-20 12:33:17,669 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-20 12:33:17,670 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:33:17,671 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-20 12:33:18,252 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2019-05-20 12:33:18,256 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:33:18,256 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:33:18,257 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:33:18,391 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-20 12:33:18,411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534a719e90>], 'label': '03cc674a-ab94-4fbb-8a74-31b1df7f271b'}
2019-05-20 12:33:18,569 (Thread-1): 12:33:18 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.97s]
2019-05-20 12:33:18,571 (Thread-1): 12:33:18 | 3 of 3 START view model GDELT_RAW.xf_spotify_date.................... [RUN]
2019-05-20 12:33:18,573 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:33:18,593 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:33:18,611 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:33:18,626 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-20 12:33:18,627 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:33:18,629 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:33:18,630 (Thread-1): On xf_spotify_date: BEGIN
2019-05-20 12:33:18,785 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-20 12:33:18,786 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:33:18,786 (Thread-1): On xf_spotify_date: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date as (
    --Reformatting dates; xf


select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-20 12:33:19,307 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2019-05-20 12:33:19,311 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:33:19,311 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:33:19,312 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:33:19,480 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-20 12:33:19,500 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534a690150>], 'label': '03cc674a-ab94-4fbb-8a74-31b1df7f271b'}
2019-05-20 12:33:19,730 (Thread-1): 12:33:19 | 3 of 3 OK created view model GDELT_RAW.xf_spotify_date............... [SUCCESS 1 in 0.92s]
2019-05-20 12:33:19,810 (MainThread): 12:33:19 | 
2019-05-20 12:33:19,812 (MainThread): 12:33:19 | Finished running 3 view models in 16.67s.
2019-05-20 12:33:20,099 (MainThread): 
2019-05-20 12:33:20,100 (MainThread): Completed successfully
2019-05-20 12:33:20,101 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-05-20 12:33:20,102 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534be63f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534be639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f534be63590>], 'label': 'end'}
2019-05-20 12:33:20,331 (MainThread): Flushing usage events
2019-05-20 12:37:50,278 (MainThread): Tracking: tracking
2019-05-20 12:37:50,279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb628d0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb628d0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb628d04d0>], 'label': 'start'}
2019-05-20 12:37:50,535 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6609b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb646b8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb64fa9210>], 'label': 'end'}
2019-05-20 12:37:50,666 (MainThread): Flushing usage events
2019-05-20 12:38:01,915 (MainThread): Tracking: tracking
2019-05-20 12:38:01,916 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d94a70650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d94a70a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d94a707d0>], 'label': 'start'}
2019-05-20 12:38:02,169 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:38:02,198 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:38:02,207 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:38:02,211 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:38:02,235 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:38:02,244 (MainThread): Parsing macros/core.sql
2019-05-20 12:38:02,253 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:38:02,314 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:38:02,330 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:38:02,336 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:38:02,339 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:38:02,355 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:38:02,400 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:38:02,409 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:38:02,429 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:38:02,460 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:38:02,477 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:38:02,491 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:38:02,505 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:38:02,509 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:38:02,512 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:38:02,516 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:38:02,543 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:38:02,560 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:38:02,568 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-20 12:38:02,576 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:38:02,662 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-20 12:38:02,664 (MainThread): 
2019-05-20 12:38:02,665 (MainThread): 12:38:02 | Concurrency: 1 threads (target='dev')
2019-05-20 12:38:02,665 (MainThread): 12:38:02 | 
2019-05-20 12:38:02,669 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:38:02,678 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:38:02,691 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:38:02,794 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:38:02,803 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:38:02,817 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:38:02,829 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-20 12:38:02,837 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:38:02,920 (MainThread): 12:38:02 | Done.
2019-05-20 12:38:02,922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d945b8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d5a9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9459a990>], 'label': 'end'}
2019-05-20 12:38:03,046 (MainThread): Flushing usage events
2019-05-20 12:38:12,086 (MainThread): Tracking: tracking
2019-05-20 12:38:12,086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7efa10650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7efa10a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7efa107d0>], 'label': 'start'}
2019-05-20 12:38:12,407 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:38:12,436 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:38:12,445 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:38:12,449 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:38:12,482 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:38:12,495 (MainThread): Parsing macros/core.sql
2019-05-20 12:38:12,508 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:38:12,575 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:38:12,592 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:38:12,598 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:38:12,602 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:38:12,618 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:38:12,666 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:38:12,675 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:38:12,697 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:38:12,728 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:38:12,745 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:38:12,759 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:38:12,774 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:38:12,778 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:38:12,781 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:38:12,784 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:38:12,811 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:38:12,829 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:38:12,837 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-20 12:38:12,845 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:38:12,922 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-20 12:38:12,924 (MainThread): 
2019-05-20 12:38:13,015 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:38:13,031 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:38:13,037 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:38:13,039 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:38:13,059 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:38:13,066 (MainThread): Parsing macros/core.sql
2019-05-20 12:38:13,075 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:38:13,137 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:38:13,154 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:38:13,159 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:38:13,163 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:38:13,178 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:38:13,219 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:38:13,227 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:38:13,247 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:38:13,278 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:38:13,295 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:38:13,310 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:38:13,324 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:38:13,328 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:38:13,331 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:38:13,334 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:38:13,524 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-20 12:38:13,525 (MainThread): Opening a new connection, currently in state init
2019-05-20 12:38:17,205 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:38:17,206 (MainThread): On list_relations_without_caching: BEGIN
2019-05-20 12:38:17,370 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-20 12:38:17,371 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:38:17,372 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-20 12:38:19,073 (MainThread): SQL status: SUCCESS 59 in 1.70 seconds
2019-05-20 12:38:19,139 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-20 12:38:19,696 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-20 12:38:19,697 (MainThread): Re-using an available connection from the pool.
2019-05-20 12:38:19,697 (MainThread): Using snowflake connection "list_schemas".
2019-05-20 12:38:19,698 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-20 12:38:22,210 (MainThread): SQL status: SUCCESS 2 in 2.51 seconds
2019-05-20 12:38:22,213 (MainThread): 12:38:22 | Concurrency: 1 threads (target='dev')
2019-05-20 12:38:22,214 (MainThread): 12:38:22 | 
2019-05-20 12:38:22,221 (Thread-1): 12:38:22 | 1 of 4 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-20 12:38:22,223 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:38:22,235 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:38:22,347 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:38:22,355 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-20 12:38:22,357 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:38:22,359 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:38:22,359 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-20 12:38:22,555 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2019-05-20 12:38:22,556 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:38:22,557 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-20 12:38:23,054 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2019-05-20 12:38:23,059 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:38:23,059 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:38:23,060 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:38:23,195 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-20 12:38:23,218 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7eddefc50>], 'label': 'cc3f7e3f-4f1f-41c2-99f9-3b3198de887c'}
2019-05-20 12:38:23,462 (Thread-1): 12:38:23 | 1 of 4 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 0.99s]
2019-05-20 12:38:23,463 (Thread-1): 12:38:23 | 2 of 4 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-20 12:38:23,465 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:38:23,486 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:38:23,504 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:38:23,509 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-20 12:38:23,510 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:38:23,512 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:38:23,512 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-20 12:38:23,889 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2019-05-20 12:38:23,890 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:38:23,890 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-20 12:38:24,405 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2019-05-20 12:38:24,409 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:38:24,409 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:38:24,409 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:38:24,547 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-20 12:38:24,570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7eddef210>], 'label': 'cc3f7e3f-4f1f-41c2-99f9-3b3198de887c'}
2019-05-20 12:38:24,792 (Thread-1): 12:38:24 | 2 of 4 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 1.10s]
2019-05-20 12:38:24,794 (Thread-1): 12:38:24 | 3 of 4 START view model GDELT_RAW.xf_spotify_date.................... [RUN]
2019-05-20 12:38:24,796 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:38:24,817 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:38:24,835 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:38:24,853 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-20 12:38:24,854 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:38:24,857 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:38:24,857 (Thread-1): On xf_spotify_date: BEGIN
2019-05-20 12:38:25,033 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-20 12:38:25,035 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:38:25,035 (Thread-1): On xf_spotify_date: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date as (
    --Reformatting dates; xf


select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-20 12:38:25,685 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2019-05-20 12:38:25,689 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:38:25,690 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:38:25,690 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:38:25,971 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2019-05-20 12:38:25,993 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f7cafe90>], 'label': 'cc3f7e3f-4f1f-41c2-99f9-3b3198de887c'}
2019-05-20 12:38:26,268 (Thread-1): 12:38:26 | 3 of 4 OK created view model GDELT_RAW.xf_spotify_date............... [SUCCESS 1 in 1.19s]
2019-05-20 12:38:26,273 (Thread-1): 12:38:26 | 4 of 4 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-20 12:38:26,275 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-20 12:38:26,289 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:38:26,307 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:38:26,332 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-20 12:38:26,333 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:38:26,335 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:38:26,336 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-20 12:38:26,485 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-20 12:38:26,486 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:38:26,487 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

select 
      Date_Added
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
    , Spotify
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
group by Date_Added 
order by Date_added asc
  );
2019-05-20 12:38:27,650 (Thread-1): Snowflake error: 001104 (42601): 018c5066-03c4-70bd-0000-090100772702: SQL compilation error: error line 9 at position 6
'XF_SPOTIFY_DATE.SPOTIFY' in select clause is neither an aggregate nor in the group by clause.
2019-05-20 12:38:27,651 (Thread-1): On xf_spotify_aggregated: ROLLBACK
2019-05-20 12:38:27,905 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7edd70090>], 'label': 'cc3f7e3f-4f1f-41c2-99f9-3b3198de887c'}
2019-05-20 12:38:28,032 (Thread-1): 12:38:28 | 4 of 4 ERROR creating view model GDELT_RAW.xf_spotify_aggregated..... [ERROR in 1.63s]
2019-05-20 12:38:28,076 (MainThread): 12:38:28 | 
2019-05-20 12:38:28,077 (MainThread): 12:38:28 | Finished running 4 view models in 15.15s.
2019-05-20 12:38:28,402 (MainThread): 
2019-05-20 12:38:28,403 (MainThread): Completed with 1 errors:
2019-05-20 12:38:28,404 (MainThread): 
2019-05-20 12:38:28,404 (MainThread): Database Error in model xf_spotify_aggregated (models/xf/xf_spotify_aggregated.sql)
2019-05-20 12:38:28,405 (MainThread):   001104 (42601): 018c5066-03c4-70bd-0000-090100772702: SQL compilation error: error line 9 at position 6
2019-05-20 12:38:28,407 (MainThread):   'XF_SPOTIFY_DATE.SPOTIFY' in select clause is neither an aggregate nor in the group by clause.
2019-05-20 12:38:28,408 (MainThread):   compiled SQL at target/compiled/gdelt/xf/xf_spotify_aggregated.sql
2019-05-20 12:38:28,410 (MainThread): 
Done. PASS=3 ERROR=1 SKIP=0 TOTAL=4
2019-05-20 12:38:28,419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7efa2ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7efa4e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7f70e06d0>], 'label': 'end'}
2019-05-20 12:38:28,548 (MainThread): Flushing usage events
2019-05-20 12:39:48,277 (MainThread): Tracking: tracking
2019-05-20 12:39:48,278 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe8430350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe8430510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe84304d0>], 'label': 'start'}
2019-05-20 12:39:48,545 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5febbfb690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fea218050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5feab09210>], 'label': 'end'}
2019-05-20 12:39:48,699 (MainThread): Flushing usage events
2019-05-20 12:40:00,462 (MainThread): Tracking: tracking
2019-05-20 12:40:00,463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdf4f0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdf4f0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdf4f07d0>], 'label': 'start'}
2019-05-20 12:40:00,710 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:40:00,734 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:40:00,740 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:40:00,743 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:40:00,763 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:40:00,772 (MainThread): Parsing macros/core.sql
2019-05-20 12:40:00,781 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:40:00,847 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:40:00,863 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:40:00,870 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:40:00,874 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:40:00,890 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:40:00,932 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:40:00,942 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:40:00,962 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:40:00,994 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:40:01,011 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:40:01,026 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:40:01,040 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:40:01,044 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:40:01,048 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:40:01,051 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:40:01,079 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:40:01,096 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:40:01,104 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-20 12:40:01,114 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:40:01,200 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-20 12:40:01,201 (MainThread): 
2019-05-20 12:40:01,202 (MainThread): 12:40:01 | Concurrency: 1 threads (target='dev')
2019-05-20 12:40:01,202 (MainThread): 12:40:01 | 
2019-05-20 12:40:01,205 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:40:01,212 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:40:01,223 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:40:01,294 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:40:01,303 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:40:01,317 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:40:01,329 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-20 12:40:01,337 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:40:01,444 (MainThread): 12:40:01 | Done.
2019-05-20 12:40:01,445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdf4f0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdf4f0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be5950b10>], 'label': 'end'}
2019-05-20 12:40:01,597 (MainThread): Flushing usage events
2019-05-20 12:40:09,735 (MainThread): Tracking: tracking
2019-05-20 12:40:09,735 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe580a30650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe580a30a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe580a307d0>], 'label': 'start'}
2019-05-20 12:40:10,048 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:40:10,085 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:40:10,093 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:40:10,096 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:40:10,117 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:40:10,124 (MainThread): Parsing macros/core.sql
2019-05-20 12:40:10,133 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:40:10,198 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:40:10,219 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:40:10,226 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:40:10,231 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:40:10,251 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:40:10,301 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:40:10,309 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:40:10,330 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:40:10,361 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:40:10,379 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:40:10,393 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:40:10,407 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:40:10,411 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:40:10,414 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:40:10,418 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:40:10,446 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:40:10,462 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:40:10,468 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-20 12:40:10,476 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:40:10,553 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-20 12:40:10,556 (MainThread): 
2019-05-20 12:40:10,647 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:40:10,664 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:40:10,669 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:40:10,672 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:40:10,691 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:40:10,698 (MainThread): Parsing macros/core.sql
2019-05-20 12:40:10,706 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:40:10,769 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:40:10,785 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:40:10,790 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:40:10,794 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:40:10,809 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:40:10,854 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:40:10,862 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:40:10,882 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:40:10,913 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:40:10,930 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:40:10,946 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:40:10,960 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:40:10,964 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:40:10,968 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:40:10,971 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:40:11,163 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-20 12:40:11,164 (MainThread): Opening a new connection, currently in state init
2019-05-20 12:40:14,611 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:40:14,612 (MainThread): On list_relations_without_caching: BEGIN
2019-05-20 12:40:14,767 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-20 12:40:14,768 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:40:14,768 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-20 12:40:16,695 (MainThread): SQL status: SUCCESS 59 in 1.93 seconds
2019-05-20 12:40:16,762 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-20 12:40:17,402 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-20 12:40:17,403 (MainThread): Re-using an available connection from the pool.
2019-05-20 12:40:17,404 (MainThread): Using snowflake connection "list_schemas".
2019-05-20 12:40:17,404 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-20 12:40:21,917 (MainThread): SQL status: SUCCESS 2 in 4.51 seconds
2019-05-20 12:40:21,920 (MainThread): 12:40:21 | Concurrency: 1 threads (target='dev')
2019-05-20 12:40:21,921 (MainThread): 12:40:21 | 
2019-05-20 12:40:21,927 (Thread-1): 12:40:21 | 1 of 4 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-20 12:40:21,929 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:40:21,941 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:40:22,049 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:40:22,057 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-20 12:40:22,059 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:40:22,060 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:40:22,061 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-20 12:40:22,236 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-20 12:40:22,237 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:40:22,237 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-20 12:40:23,961 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2019-05-20 12:40:23,968 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:40:23,969 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:40:23,969 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:40:24,109 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-20 12:40:24,131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ee0fc50>], 'label': '5c91edc7-7a79-4589-b786-6f337fe5b758'}
2019-05-20 12:40:24,380 (Thread-1): 12:40:24 | 1 of 4 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 2.20s]
2019-05-20 12:40:24,381 (Thread-1): 12:40:24 | 2 of 4 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-20 12:40:24,384 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:40:24,406 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:40:24,424 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:40:24,430 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-20 12:40:24,431 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:40:24,432 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:40:24,432 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-20 12:40:24,583 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-20 12:40:24,584 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:40:24,584 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-20 12:40:25,156 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2019-05-20 12:40:25,160 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:40:25,160 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:40:25,161 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:40:25,292 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-20 12:40:25,315 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ee0f310>], 'label': '5c91edc7-7a79-4589-b786-6f337fe5b758'}
2019-05-20 12:40:25,448 (Thread-1): 12:40:25 | 2 of 4 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.93s]
2019-05-20 12:40:25,450 (Thread-1): 12:40:25 | 3 of 4 START view model GDELT_RAW.xf_spotify_date.................... [RUN]
2019-05-20 12:40:25,452 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:40:25,473 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:40:25,491 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:40:25,499 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-20 12:40:25,500 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:40:25,503 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:40:25,503 (Thread-1): On xf_spotify_date: BEGIN
2019-05-20 12:40:25,888 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2019-05-20 12:40:25,889 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:40:25,889 (Thread-1): On xf_spotify_date: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date as (
    --Reformatting dates; xf


select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-20 12:40:26,519 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2019-05-20 12:40:26,522 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:40:26,523 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:40:26,523 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:40:26,670 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-20 12:40:26,691 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe588100290>], 'label': '5c91edc7-7a79-4589-b786-6f337fe5b758'}
2019-05-20 12:40:26,913 (Thread-1): 12:40:26 | 3 of 4 OK created view model GDELT_RAW.xf_spotify_date............... [SUCCESS 1 in 1.24s]
2019-05-20 12:40:26,918 (Thread-1): 12:40:26 | 4 of 4 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-20 12:40:26,920 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-20 12:40:26,934 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:40:26,953 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:40:26,968 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-20 12:40:26,969 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:40:26,972 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:40:26,972 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-20 12:40:27,243 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2019-05-20 12:40:27,244 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:40:27,245 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-20 12:40:27,766 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2019-05-20 12:40:27,770 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-20 12:40:27,771 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:40:27,771 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-20 12:40:27,926 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-20 12:40:27,951 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ed90210>], 'label': '5c91edc7-7a79-4589-b786-6f337fe5b758'}
2019-05-20 12:40:28,180 (Thread-1): 12:40:28 | 4 of 4 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 1.03s]
2019-05-20 12:40:28,209 (MainThread): 12:40:28 | 
2019-05-20 12:40:28,210 (MainThread): 12:40:28 | Finished running 4 view models in 17.65s.
2019-05-20 12:40:29,057 (MainThread): 
2019-05-20 12:40:29,058 (MainThread): Completed successfully
2019-05-20 12:40:29,059 (MainThread): 
Done. PASS=4 ERROR=0 SKIP=0 TOTAL=4
2019-05-20 12:40:29,060 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe580a4ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe580a6e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe588100ed0>], 'label': 'end'}
2019-05-20 12:40:29,216 (MainThread): Flushing usage events
2019-05-20 12:43:42,731 (MainThread): Tracking: tracking
2019-05-20 12:43:42,732 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84b131690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84b131a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84b131810>], 'label': 'start'}
2019-05-20 12:43:43,059 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:43:43,081 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:43:43,087 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:43:43,090 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:43:43,109 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:43:43,117 (MainThread): Parsing macros/core.sql
2019-05-20 12:43:43,126 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:43:43,194 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:43:43,210 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:43:43,215 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:43:43,220 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:43:43,235 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:43:43,280 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:43:43,289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:43:43,321 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:43:43,373 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:43:43,390 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:43:43,405 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:43:43,419 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:43:43,423 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:43:43,426 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:43:43,430 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:43:43,456 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:43:43,475 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:43:43,483 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-20 12:43:43,491 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:43:43,578 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-20 12:43:43,580 (MainThread): 
2019-05-20 12:43:43,580 (MainThread): 12:43:43 | Concurrency: 1 threads (target='dev')
2019-05-20 12:43:43,581 (MainThread): 12:43:43 | 
2019-05-20 12:43:43,585 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:43:43,593 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:43:43,601 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:43:43,672 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:43:43,680 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:43:43,693 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:43:43,704 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-20 12:43:43,712 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:43:43,818 (MainThread): 12:43:43 | Done.
2019-05-20 12:43:43,819 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84ac78bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8535cb090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84ac59b10>], 'label': 'end'}
2019-05-20 12:43:44,158 (MainThread): Flushing usage events
2019-05-20 12:43:58,923 (MainThread): Tracking: tracking
2019-05-20 12:43:58,923 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c856b1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c856b1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c856b1810>], 'label': 'start'}
2019-05-20 12:43:59,243 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:43:59,271 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:43:59,276 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:43:59,279 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:43:59,298 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:43:59,306 (MainThread): Parsing macros/core.sql
2019-05-20 12:43:59,315 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:43:59,379 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:43:59,396 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:43:59,401 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:43:59,405 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:43:59,420 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:43:59,465 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:43:59,474 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:43:59,490 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:43:59,522 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:43:59,539 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:43:59,554 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:43:59,569 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:43:59,573 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:43:59,576 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:43:59,579 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:43:59,606 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-20 12:43:59,623 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-20 12:43:59,631 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-20 12:43:59,640 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-20 12:43:59,716 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-20 12:43:59,718 (MainThread): 
2019-05-20 12:43:59,810 (MainThread): Parsing macros/adapters.sql
2019-05-20 12:43:59,826 (MainThread): Parsing macros/catalog.sql
2019-05-20 12:43:59,831 (MainThread): Parsing macros/materializations/merge.sql
2019-05-20 12:43:59,834 (MainThread): Parsing macros/materializations/table.sql
2019-05-20 12:43:59,853 (MainThread): Parsing macros/materializations/view.sql
2019-05-20 12:43:59,860 (MainThread): Parsing macros/core.sql
2019-05-20 12:43:59,868 (MainThread): Parsing macros/adapters/common.sql
2019-05-20 12:43:59,931 (MainThread): Parsing macros/etc/datetime.sql
2019-05-20 12:43:59,947 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-20 12:43:59,952 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-20 12:43:59,956 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-20 12:43:59,972 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-20 12:44:00,021 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-20 12:44:00,030 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-20 12:44:00,050 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-20 12:44:00,082 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-20 12:44:00,099 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-20 12:44:00,113 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-20 12:44:00,127 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-20 12:44:00,132 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-20 12:44:00,137 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-20 12:44:00,141 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-20 12:44:00,335 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-20 12:44:00,335 (MainThread): Opening a new connection, currently in state init
2019-05-20 12:44:03,880 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:44:03,881 (MainThread): On list_relations_without_caching: BEGIN
2019-05-20 12:44:04,131 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2019-05-20 12:44:04,132 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-20 12:44:04,133 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-20 12:44:05,965 (MainThread): SQL status: SUCCESS 58 in 1.83 seconds
2019-05-20 12:44:06,043 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-20 12:44:06,666 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-20 12:44:06,666 (MainThread): Re-using an available connection from the pool.
2019-05-20 12:44:06,667 (MainThread): Using snowflake connection "list_schemas".
2019-05-20 12:44:06,667 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-20 12:44:08,826 (MainThread): SQL status: SUCCESS 2 in 2.16 seconds
2019-05-20 12:44:08,829 (MainThread): 12:44:08 | Concurrency: 1 threads (target='dev')
2019-05-20 12:44:08,830 (MainThread): 12:44:08 | 
2019-05-20 12:44:08,837 (Thread-1): 12:44:08 | 1 of 4 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-20 12:44:08,839 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-20 12:44:08,858 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:44:08,982 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-20 12:44:08,987 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-20 12:44:08,989 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:44:08,991 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:44:08,991 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-20 12:44:09,305 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2019-05-20 12:44:09,306 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:44:09,306 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-20 12:44:09,829 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2019-05-20 12:44:09,834 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:44:09,834 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-20 12:44:09,834 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-20 12:44:10,124 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2019-05-20 12:44:10,146 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c83a8fb50>], 'label': 'b64127e4-a97c-4065-abbc-3ca655f04393'}
2019-05-20 12:44:10,383 (Thread-1): 12:44:10 | 1 of 4 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 1.30s]
2019-05-20 12:44:10,384 (Thread-1): 12:44:10 | 2 of 4 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-20 12:44:10,387 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-20 12:44:10,409 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:44:10,427 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-20 12:44:10,433 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-20 12:44:10,434 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:44:10,435 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:44:10,435 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-20 12:44:10,626 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-20 12:44:10,628 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:44:10,628 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-20 12:44:11,189 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2019-05-20 12:44:11,193 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:44:11,194 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-20 12:44:11,194 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-20 12:44:11,319 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-05-20 12:44:11,340 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c83a09890>], 'label': 'b64127e4-a97c-4065-abbc-3ca655f04393'}
2019-05-20 12:44:11,572 (Thread-1): 12:44:11 | 2 of 4 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.95s]
2019-05-20 12:44:11,574 (Thread-1): 12:44:11 | 3 of 4 START table model GDELT_RAW.xf_spotify_date................... [RUN]
2019-05-20 12:44:11,576 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-20 12:44:11,598 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:44:11,683 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-20 12:44:11,684 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:44:11,684 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:44:11,685 (Thread-1): On xf_spotify_date: drop table if exists SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date__dbt_tmp cascade
2019-05-20 12:44:11,946 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2019-05-20 12:44:11,956 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-20 12:44:11,970 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:44:11,970 (Thread-1): On xf_spotify_date: BEGIN
2019-05-20 12:44:12,222 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2019-05-20 12:44:12,223 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:44:12,223 (Thread-1): On xf_spotify_date: create transient table SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date__dbt_tmp
  as (
    --Reformatting dates; xf


select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-20 12:44:23,947 (Thread-1): SQL status: SUCCESS 1 in 11.72 seconds
2019-05-20 12:44:23,970 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:44:23,970 (Thread-1): On xf_spotify_date: alter table SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date__dbt_tmp rename to SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
2019-05-20 12:44:24,244 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2019-05-20 12:44:24,248 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:44:24,249 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:44:24,249 (Thread-1): On xf_spotify_date: COMMIT
2019-05-20 12:44:24,441 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-20 12:44:24,450 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-20 12:44:24,451 (Thread-1): On xf_spotify_date: drop table if exists SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date__dbt_backup cascade
2019-05-20 12:44:25,022 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2019-05-20 12:44:25,049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c84136a10>], 'label': 'b64127e4-a97c-4065-abbc-3ca655f04393'}
2019-05-20 12:44:25,363 (Thread-1): 12:44:25 | 3 of 4 OK created table model GDELT_RAW.xf_spotify_date.............. [SUCCESS 1 in 13.47s]
2019-05-20 12:44:25,368 (Thread-1): 12:44:25 | 4 of 4 START table model GDELT_RAW.xf_spotify_aggregated............. [RUN]
2019-05-20 12:44:25,370 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-20 12:44:25,383 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:44:25,519 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:25,520 (Thread-1): Re-using an available connection from the pool.
2019-05-20 12:44:25,520 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:25,521 (Thread-1): On xf_spotify_aggregated: drop table if exists SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated__dbt_tmp cascade
2019-05-20 12:44:25,914 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2019-05-20 12:44:25,923 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-20 12:44:25,941 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:25,942 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-20 12:44:26,138 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2019-05-20 12:44:26,140 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:26,141 (Thread-1): On xf_spotify_aggregated: create transient table SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated__dbt_tmp
  as (
    --aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-20 12:44:26,854 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2019-05-20 12:44:26,877 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:26,878 (Thread-1): On xf_spotify_aggregated: alter table SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated__dbt_tmp rename to SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated
2019-05-20 12:44:27,172 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2019-05-20 12:44:27,176 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-20 12:44:27,177 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:27,177 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-20 12:44:27,306 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-20 12:44:27,315 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-20 12:44:27,316 (Thread-1): On xf_spotify_aggregated: drop table if exists SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated__dbt_backup cascade
2019-05-20 12:44:27,482 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-20 12:44:27,507 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c83a9b8d0>], 'label': 'b64127e4-a97c-4065-abbc-3ca655f04393'}
2019-05-20 12:44:27,971 (Thread-1): 12:44:27 | 4 of 4 OK created table model GDELT_RAW.xf_spotify_aggregated........ [SUCCESS 1 in 2.13s]
2019-05-20 12:44:28,054 (MainThread): 12:44:28 | 
2019-05-20 12:44:28,056 (MainThread): 12:44:28 | Finished running 2 table models, 2 view models in 28.34s.
2019-05-20 12:44:28,327 (MainThread): 
2019-05-20 12:44:28,327 (MainThread): Completed successfully
2019-05-20 12:44:28,328 (MainThread): 
Done. PASS=4 ERROR=0 SKIP=0 TOTAL=4
2019-05-20 12:44:28,330 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c856d0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c8cda63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c8cda6a90>], 'label': 'end'}
2019-05-20 12:44:28,571 (MainThread): Flushing usage events
2019-05-21 10:34:22,725 (MainThread): Tracking: tracking
2019-05-21 10:34:22,730 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28f950410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28f950e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28f950a90>], 'label': 'start'}
2019-05-21 10:34:22,969 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa292029210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29587d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29311b690>], 'label': 'end'}
2019-05-21 10:34:23,170 (MainThread): Flushing usage events
2019-05-21 10:34:37,595 (MainThread): Tracking: tracking
2019-05-21 10:34:37,596 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ddd31690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ddd31a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ddd31810>], 'label': 'start'}
2019-05-21 10:34:37,842 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:34:37,853 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:34:37,859 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:34:37,865 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:34:37,876 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:34:37,885 (MainThread): Parsing macros/core.sql
2019-05-21 10:34:37,893 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:34:37,920 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:34:37,930 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:34:37,936 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:34:37,943 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:34:37,953 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:34:37,973 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:34:37,981 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:34:37,992 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:34:38,008 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:34:38,018 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:34:38,027 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:34:38,037 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:34:38,043 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:34:38,049 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:34:38,054 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:34:38,072 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:34:38,078 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:34:38,081 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:34:38,084 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:34:38,121 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:34:38,122 (MainThread): 
2019-05-21 10:34:38,122 (MainThread): 10:34:38 | Concurrency: 1 threads (target='dev')
2019-05-21 10:34:38,123 (MainThread): 10:34:38 | 
2019-05-21 10:34:38,125 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:34:38,127 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:34:38,133 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:34:38,166 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:34:38,171 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:34:38,175 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:34:38,182 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:34:38,187 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:34:38,232 (MainThread): 10:34:38 | Done.
2019-05-21 10:34:38,232 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2dd878bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e61cb090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2dd8597d0>], 'label': 'end'}
2019-05-21 10:34:38,405 (MainThread): Flushing usage events
2019-05-21 10:34:42,824 (MainThread): Tracking: tracking
2019-05-21 10:34:42,824 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfccf1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfccf1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfccf1810>], 'label': 'start'}
2019-05-21 10:34:42,955 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:34:42,961 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:34:42,963 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:34:42,964 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:34:42,971 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:34:42,973 (MainThread): Parsing macros/core.sql
2019-05-21 10:34:42,976 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:34:42,998 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:34:43,003 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:34:43,005 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:34:43,006 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:34:43,011 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:34:43,026 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:34:43,029 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:34:43,036 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:34:43,046 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:34:43,052 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:34:43,057 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:34:43,062 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:34:43,063 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:34:43,065 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:34:43,066 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:34:43,075 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:34:43,081 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:34:43,084 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:34:43,087 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:34:43,116 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:34:43,117 (MainThread): 
2019-05-21 10:34:43,155 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:34:43,161 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:34:43,163 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:34:43,163 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:34:43,170 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:34:43,172 (MainThread): Parsing macros/core.sql
2019-05-21 10:34:43,175 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:34:43,196 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:34:43,201 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:34:43,203 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:34:43,205 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:34:43,210 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:34:43,225 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:34:43,228 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:34:43,235 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:34:43,245 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:34:43,253 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:34:43,260 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:34:43,265 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:34:43,266 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:34:43,267 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:34:43,268 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:34:43,335 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:34:43,335 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:34:45,552 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:34:45,552 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:34:45,719 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:34:45,720 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:34:45,720 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:34:47,649 (MainThread): SQL status: SUCCESS 58 in 1.93 seconds
2019-05-21 10:34:47,666 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:34:47,965 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:34:47,966 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:34:47,966 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:34:47,966 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:34:49,784 (MainThread): SQL status: SUCCESS 2 in 1.82 seconds
2019-05-21 10:34:49,785 (MainThread): 10:34:49 | Concurrency: 1 threads (target='dev')
2019-05-21 10:34:49,786 (MainThread): 10:34:49 | 
2019-05-21 10:34:49,787 (Thread-1): 10:34:49 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 10:34:49,788 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:34:49,790 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:34:49,815 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:34:49,819 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 10:34:49,820 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:34:49,820 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:34:49,820 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 10:34:49,986 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:34:49,987 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:34:49,987 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 10:34:50,404 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2019-05-21 10:34:50,405 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:34:50,405 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:34:50,405 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:34:50,544 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-21 10:34:50,549 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb0d0b50>], 'label': 'cc5c011a-6e1c-42fa-b69b-f21d53f34faa'}
2019-05-21 10:34:50,646 (Thread-1): 10:34:50 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 0.76s]
2019-05-21 10:34:50,647 (Thread-1): 10:34:50 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 10:34:50,648 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:34:50,652 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:34:50,659 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:34:50,662 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 10:34:50,662 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:34:50,663 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:34:50,663 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 10:34:50,861 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2019-05-21 10:34:50,861 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:34:50,861 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 10:34:51,363 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2019-05-21 10:34:51,364 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:34:51,364 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:34:51,364 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:34:51,496 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-21 10:34:51,500 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb04ab90>], 'label': 'cc5c011a-6e1c-42fa-b69b-f21d53f34faa'}
2019-05-21 10:34:51,679 (Thread-1): 10:34:51 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.85s]
2019-05-21 10:34:51,680 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:34:51,685 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:34:51,695 (Thread-1): 10:34:51 | 3 of 3 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:34:51,696 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:34:51,701 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:34:51,705 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:34:51,716 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:34:51,716 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:34:51,717 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:34:51,717 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:34:51,886 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:34:51,886 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:34:51,886 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    with __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
)--aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from __dbt__CTE__xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:34:52,482 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2019-05-21 10:34:52,483 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:34:52,483 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:34:52,483 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:34:52,629 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:34:52,634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb78fa90>], 'label': 'cc5c011a-6e1c-42fa-b69b-f21d53f34faa'}
2019-05-21 10:34:52,823 (Thread-1): 10:34:52 | 3 of 3 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 0.94s]
2019-05-21 10:34:52,903 (MainThread): 10:34:52 | 
2019-05-21 10:34:52,904 (MainThread): 10:34:52 | Finished running 3 view models in 9.79s.
2019-05-21 10:34:53,150 (MainThread): 
2019-05-21 10:34:53,151 (MainThread): Completed successfully
2019-05-21 10:34:53,151 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-05-21 10:34:53,151 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfcd10bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb04ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb04afd0>], 'label': 'end'}
2019-05-21 10:34:53,249 (MainThread): Flushing usage events
2019-05-21 10:36:35,380 (MainThread): Tracking: tracking
2019-05-21 10:36:35,381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79b190410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79b190e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79b190a90>], 'label': 'start'}
2019-05-21 10:36:35,521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79d869210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7a109d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79e95b690>], 'label': 'end'}
2019-05-21 10:36:35,689 (MainThread): Flushing usage events
2019-05-21 10:36:43,216 (MainThread): Tracking: tracking
2019-05-21 10:36:43,216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b86f1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b86f1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b86f1810>], 'label': 'start'}
2019-05-21 10:36:43,434 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:36:43,440 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:36:43,442 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:36:43,442 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:36:43,450 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:36:43,453 (MainThread): Parsing macros/core.sql
2019-05-21 10:36:43,456 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:36:43,478 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:36:43,483 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:36:43,485 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:36:43,486 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:36:43,491 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:36:43,506 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:36:43,509 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:36:43,515 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:36:43,526 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:36:43,531 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:36:43,536 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:36:43,541 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:36:43,542 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:36:43,543 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:36:43,544 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:36:43,553 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:36:43,559 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:36:43,562 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:36:43,564 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:36:43,594 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:36:43,595 (MainThread): 
2019-05-21 10:36:43,596 (MainThread): 10:36:43 | Concurrency: 1 threads (target='dev')
2019-05-21 10:36:43,596 (MainThread): 10:36:43 | 
2019-05-21 10:36:43,598 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:36:43,601 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:36:43,607 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:36:43,639 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:36:43,644 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:36:43,649 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:36:43,659 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:36:43,662 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:36:43,706 (MainThread): 10:36:43 | Done.
2019-05-21 10:36:43,707 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c0b8b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b821a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b821af10>], 'label': 'end'}
2019-05-21 10:36:43,904 (MainThread): Flushing usage events
2019-05-21 10:36:47,819 (MainThread): Tracking: tracking
2019-05-21 10:36:47,819 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566a71690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566a71a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566a71810>], 'label': 'start'}
2019-05-21 10:36:48,068 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:36:48,075 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:36:48,077 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:36:48,078 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:36:48,085 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:36:48,088 (MainThread): Parsing macros/core.sql
2019-05-21 10:36:48,093 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:36:48,120 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:36:48,126 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:36:48,128 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:36:48,130 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:36:48,137 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:36:48,155 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:36:48,158 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:36:48,168 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:36:48,179 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:36:48,185 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:36:48,190 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:36:48,195 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:36:48,196 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:36:48,198 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:36:48,199 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:36:48,211 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:36:48,218 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:36:48,222 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:36:48,226 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:36:48,258 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:36:48,259 (MainThread): 
2019-05-21 10:36:48,304 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:36:48,310 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:36:48,312 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:36:48,313 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:36:48,321 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:36:48,323 (MainThread): Parsing macros/core.sql
2019-05-21 10:36:48,326 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:36:48,351 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:36:48,357 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:36:48,360 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:36:48,361 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:36:48,367 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:36:48,384 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:36:48,388 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:36:48,396 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:36:48,409 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:36:48,416 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:36:48,421 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:36:48,427 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:36:48,429 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:36:48,430 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:36:48,431 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:36:48,508 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:36:48,509 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:36:50,242 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:36:50,243 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:36:50,389 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:36:50,389 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:36:50,389 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:36:52,119 (MainThread): SQL status: SUCCESS 59 in 1.73 seconds
2019-05-21 10:36:52,136 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:36:52,447 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:36:52,447 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:36:52,447 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:36:52,447 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:36:54,149 (MainThread): SQL status: SUCCESS 2 in 1.70 seconds
2019-05-21 10:36:54,150 (MainThread): 10:36:54 | Concurrency: 1 threads (target='dev')
2019-05-21 10:36:54,150 (MainThread): 10:36:54 | 
2019-05-21 10:36:54,152 (Thread-1): 10:36:54 | 1 of 4 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 10:36:54,152 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:36:54,155 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:36:54,179 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:36:54,182 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 10:36:54,182 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:36:54,183 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:36:54,183 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 10:36:54,428 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2019-05-21 10:36:54,428 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:36:54,428 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 10:36:55,037 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2019-05-21 10:36:55,038 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:36:55,038 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:36:55,038 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:36:55,185 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:36:55,191 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564e51b50>], 'label': '5cc707ce-a902-4022-beab-74a86d429084'}
2019-05-21 10:36:55,314 (Thread-1): 10:36:55 | 1 of 4 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 1.04s]
2019-05-21 10:36:55,314 (Thread-1): 10:36:55 | 2 of 4 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 10:36:55,315 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:36:55,319 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:36:55,326 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:36:55,329 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 10:36:55,330 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:36:55,330 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:36:55,330 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 10:36:55,493 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-21 10:36:55,493 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:36:55,493 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 10:36:56,003 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2019-05-21 10:36:56,004 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:36:56,004 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:36:56,005 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:36:56,174 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:36:56,179 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56edc7c10>], 'label': '5cc707ce-a902-4022-beab-74a86d429084'}
2019-05-21 10:36:56,288 (Thread-1): 10:36:56 | 2 of 4 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.86s]
2019-05-21 10:36:56,288 (Thread-1): 10:36:56 | 3 of 4 START view model GDELT_RAW.xf_spotify_date.................... [RUN]
2019-05-21 10:36:56,289 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:36:56,295 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:36:56,299 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:36:56,308 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-21 10:36:56,309 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:36:56,309 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:36:56,309 (Thread-1): On xf_spotify_date: BEGIN
2019-05-21 10:36:56,483 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:36:56,484 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:36:56,484 (Thread-1): On xf_spotify_date: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date as (
    --Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-21 10:36:57,607 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2019-05-21 10:36:57,608 (Thread-1): On xf_spotify_date: COMMIT
2019-05-21 10:36:57,608 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:36:57,608 (Thread-1): On xf_spotify_date: COMMIT
2019-05-21 10:36:57,732 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2019-05-21 10:36:57,737 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56edc7c10>], 'label': '5cc707ce-a902-4022-beab-74a86d429084'}
2019-05-21 10:36:57,834 (Thread-1): 10:36:57 | 3 of 4 OK created view model GDELT_RAW.xf_spotify_date............... [SUCCESS 1 in 1.45s]
2019-05-21 10:36:57,836 (Thread-1): 10:36:57 | 4 of 4 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:36:57,836 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:36:57,839 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:36:57,843 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:36:57,846 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:36:57,847 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:36:57,847 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:36:57,847 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:36:58,026 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 10:36:58,027 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:36:58,027 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:36:58,538 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2019-05-21 10:36:58,539 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:36:58,539 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:36:58,539 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:36:58,688 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:36:58,692 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564e5dd10>], 'label': '5cc707ce-a902-4022-beab-74a86d429084'}
2019-05-21 10:36:58,814 (Thread-1): 10:36:58 | 4 of 4 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 0.86s]
2019-05-21 10:36:58,872 (MainThread): 10:36:58 | 
2019-05-21 10:36:58,872 (MainThread): 10:36:58 | Finished running 4 view models in 10.61s.
2019-05-21 10:36:59,122 (MainThread): 
2019-05-21 10:36:59,122 (MainThread): Completed successfully
2019-05-21 10:36:59,123 (MainThread): 
Done. PASS=4 ERROR=0 SKIP=0 TOTAL=4
2019-05-21 10:36:59,123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566a8fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564dc2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56e1663d0>], 'label': 'end'}
2019-05-21 10:36:59,299 (MainThread): Flushing usage events
2019-05-21 10:39:22,096 (MainThread): Tracking: tracking
2019-05-21 10:39:22,096 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabca031690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabca031a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabca031810>], 'label': 'start'}
2019-05-21 10:39:22,330 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:39:22,336 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:39:22,338 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:39:22,339 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:39:22,345 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:39:22,349 (MainThread): Parsing macros/core.sql
2019-05-21 10:39:22,352 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:39:22,374 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:39:22,379 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:39:22,381 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:39:22,382 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:39:22,387 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:39:22,403 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:39:22,406 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:39:22,413 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:39:22,423 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:39:22,429 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:39:22,433 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:39:22,438 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:39:22,440 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:39:22,441 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:39:22,442 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:39:22,452 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:39:22,457 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:39:22,460 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:39:22,463 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:39:22,490 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:39:22,492 (MainThread): 
2019-05-21 10:39:22,534 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:39:22,542 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:39:22,544 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:39:22,545 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:39:22,552 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:39:22,554 (MainThread): Parsing macros/core.sql
2019-05-21 10:39:22,557 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:39:22,580 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:39:22,586 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:39:22,588 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:39:22,590 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:39:22,595 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:39:22,609 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:39:22,612 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:39:22,619 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:39:22,630 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:39:22,635 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:39:22,640 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:39:22,645 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:39:22,646 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:39:22,647 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:39:22,648 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:39:22,715 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:39:22,715 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:39:24,303 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:39:24,303 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:39:24,475 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:39:24,476 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:39:24,476 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:39:25,828 (MainThread): SQL status: SUCCESS 56 in 1.35 seconds
2019-05-21 10:39:25,845 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:39:26,167 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:39:26,167 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:39:26,168 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:39:26,168 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:39:28,759 (MainThread): SQL status: SUCCESS 2 in 2.59 seconds
2019-05-21 10:39:28,760 (MainThread): 10:39:28 | Concurrency: 1 threads (target='dev')
2019-05-21 10:39:28,761 (MainThread): 10:39:28 | 
2019-05-21 10:39:28,762 (Thread-1): 10:39:28 | 1 of 4 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 10:39:28,763 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:39:28,765 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:39:28,790 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:39:28,792 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 10:39:28,792 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:39:28,792 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:39:28,792 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 10:39:28,966 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:39:28,966 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:39:28,966 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 10:39:29,619 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2019-05-21 10:39:29,620 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:39:29,620 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:39:29,620 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:39:29,773 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:39:29,778 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8418bd0>], 'label': '148cb958-e8d7-453d-9cce-5af83ac5196a'}
2019-05-21 10:39:29,907 (Thread-1): 10:39:29 | 1 of 4 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 1.01s]
2019-05-21 10:39:29,908 (Thread-1): 10:39:29 | 2 of 4 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 10:39:29,908 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:39:29,913 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:39:29,919 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:39:29,920 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 10:39:29,920 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:39:29,920 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:39:29,921 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 10:39:30,099 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 10:39:30,099 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:39:30,099 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 10:39:30,483 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2019-05-21 10:39:30,484 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:39:30,484 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:39:30,484 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:39:30,619 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-21 10:39:30,624 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8418610>], 'label': '148cb958-e8d7-453d-9cce-5af83ac5196a'}
2019-05-21 10:39:30,757 (Thread-1): 10:39:30 | 2 of 4 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.72s]
2019-05-21 10:39:30,758 (Thread-1): 10:39:30 | 3 of 4 START view model GDELT_RAW.xf_spotify_date.................... [RUN]
2019-05-21 10:39:30,758 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:39:30,763 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:39:30,772 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:39:30,774 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-21 10:39:30,774 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:39:30,774 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:39:30,775 (Thread-1): On xf_spotify_date: BEGIN
2019-05-21 10:39:30,932 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-21 10:39:30,932 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:39:30,932 (Thread-1): On xf_spotify_date: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date as (
    --Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where lower(SOURCEURL) like '%spotfiy%' and NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-21 10:39:31,342 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2019-05-21 10:39:31,343 (Thread-1): On xf_spotify_date: COMMIT
2019-05-21 10:39:31,343 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:39:31,343 (Thread-1): On xf_spotify_date: COMMIT
2019-05-21 10:39:31,530 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-21 10:39:31,534 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8391fd0>], 'label': '148cb958-e8d7-453d-9cce-5af83ac5196a'}
2019-05-21 10:39:31,690 (Thread-1): 10:39:31 | 3 of 4 OK created view model GDELT_RAW.xf_spotify_date............... [SUCCESS 1 in 0.78s]
2019-05-21 10:39:31,692 (Thread-1): 10:39:31 | 4 of 4 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:39:31,692 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:39:31,696 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:39:31,700 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:39:31,704 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:39:31,704 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:39:31,705 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:39:31,705 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:39:31,878 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:39:31,878 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:39:31,878 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:39:32,421 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2019-05-21 10:39:32,422 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:39:32,422 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:39:32,422 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:39:32,572 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:39:32,577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc838b950>], 'label': '148cb958-e8d7-453d-9cce-5af83ac5196a'}
2019-05-21 10:39:32,671 (Thread-1): 10:39:32 | 4 of 4 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 0.88s]
2019-05-21 10:39:32,682 (MainThread): 10:39:32 | 
2019-05-21 10:39:32,682 (MainThread): 10:39:32 | Finished running 4 view models in 10.19s.
2019-05-21 10:39:32,922 (MainThread): 
2019-05-21 10:39:32,923 (MainThread): Completed successfully
2019-05-21 10:39:32,923 (MainThread): 
Done. PASS=4 ERROR=0 SKIP=0 TOTAL=4
2019-05-21 10:39:32,923 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabca050bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd1783450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc8391290>], 'label': 'end'}
2019-05-21 10:39:33,034 (MainThread): Flushing usage events
2019-05-21 10:42:35,931 (MainThread): Tracking: tracking
2019-05-21 10:42:35,932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa119f10410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa119f10e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa119f10a90>], 'label': 'start'}
2019-05-21 10:42:36,084 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11c5e9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11fddd350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11d6db690>], 'label': 'end'}
2019-05-21 10:42:36,233 (MainThread): Flushing usage events
2019-05-21 10:42:41,139 (MainThread): Tracking: tracking
2019-05-21 10:42:41,139 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835ed6f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835ed6fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835ed6f810>], 'label': 'start'}
2019-05-21 10:42:41,598 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:42:41,604 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:42:41,606 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:42:41,606 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:42:41,613 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:42:41,616 (MainThread): Parsing macros/core.sql
2019-05-21 10:42:41,619 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:42:41,641 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:42:41,648 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:42:41,650 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:42:41,651 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:42:41,656 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:42:41,671 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:42:41,674 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:42:41,680 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:42:41,691 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:42:41,696 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:42:41,701 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:42:41,706 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:42:41,707 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:42:41,708 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:42:41,710 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:42:41,719 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:42:41,724 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:42:41,727 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:42:41,730 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:42:41,760 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:42:41,761 (MainThread): 
2019-05-21 10:42:41,761 (MainThread): 10:42:41 | Concurrency: 1 threads (target='dev')
2019-05-21 10:42:41,762 (MainThread): 10:42:41 | 
2019-05-21 10:42:41,763 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:42:41,766 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:42:41,772 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:42:41,804 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:42:41,809 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:42:41,813 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:42:41,819 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:42:41,822 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:42:41,877 (MainThread): 10:42:41 | Done.
2019-05-21 10:42:41,878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835ed6f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835e802e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836718b090>], 'label': 'end'}
2019-05-21 10:42:41,982 (MainThread): Flushing usage events
2019-05-21 10:42:46,168 (MainThread): Tracking: tracking
2019-05-21 10:42:46,168 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653bf91690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653bf91a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653bf91810>], 'label': 'start'}
2019-05-21 10:42:46,385 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:42:46,393 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:42:46,396 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:42:46,397 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:42:46,404 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:42:46,409 (MainThread): Parsing macros/core.sql
2019-05-21 10:42:46,413 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:42:46,438 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:42:46,445 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:42:46,448 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:42:46,449 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:42:46,454 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:42:46,471 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:42:46,475 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:42:46,483 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:42:46,495 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:42:46,501 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:42:46,507 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:42:46,514 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:42:46,515 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:42:46,516 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:42:46,517 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:42:46,530 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:42:46,536 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:42:46,540 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:42:46,544 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:42:46,577 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:42:46,578 (MainThread): 
2019-05-21 10:42:46,626 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:42:46,633 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:42:46,635 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:42:46,636 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:42:46,645 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:42:46,647 (MainThread): Parsing macros/core.sql
2019-05-21 10:42:46,650 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:42:46,674 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:42:46,680 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:42:46,682 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:42:46,683 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:42:46,688 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:42:46,705 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:42:46,709 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:42:46,716 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:42:46,728 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:42:46,733 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:42:46,738 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:42:46,743 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:42:46,745 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:42:46,746 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:42:46,747 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:42:46,811 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:42:46,812 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:42:48,398 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:42:48,398 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:42:48,602 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2019-05-21 10:42:48,602 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:42:48,602 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:42:50,861 (MainThread): SQL status: SUCCESS 60 in 2.26 seconds
2019-05-21 10:42:50,878 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:42:51,184 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:42:51,184 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:42:51,184 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:42:51,185 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:42:52,605 (MainThread): SQL status: SUCCESS 2 in 1.42 seconds
2019-05-21 10:42:52,606 (MainThread): 10:42:52 | Concurrency: 1 threads (target='dev')
2019-05-21 10:42:52,606 (MainThread): 10:42:52 | 
2019-05-21 10:42:52,608 (Thread-1): 10:42:52 | 1 of 4 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 10:42:52,608 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:42:52,613 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:42:52,641 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:42:52,644 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 10:42:52,644 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:42:52,645 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:42:52,645 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 10:42:52,806 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-21 10:42:52,807 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:42:52,807 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 10:42:53,256 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2019-05-21 10:42:53,258 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:42:53,258 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:42:53,258 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:42:53,435 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 10:42:53,439 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653a372950>], 'label': '139bad55-1c3a-46e9-bec5-8a605806333a'}
2019-05-21 10:42:53,607 (Thread-1): 10:42:53 | 1 of 4 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 0.83s]
2019-05-21 10:42:53,608 (Thread-1): 10:42:53 | 2 of 4 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 10:42:53,608 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:42:53,614 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:42:53,620 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:42:53,622 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 10:42:53,623 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:42:53,623 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:42:53,623 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 10:42:53,908 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2019-05-21 10:42:53,908 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:42:53,908 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 10:42:54,338 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2019-05-21 10:42:54,339 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:42:54,339 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:42:54,339 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:42:54,478 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-21 10:42:54,483 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654422fe90>], 'label': '139bad55-1c3a-46e9-bec5-8a605806333a'}
2019-05-21 10:42:54,580 (Thread-1): 10:42:54 | 2 of 4 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.87s]
2019-05-21 10:42:54,580 (Thread-1): 10:42:54 | 3 of 4 START view model GDELT_RAW.xf_spotify_date.................... [RUN]
2019-05-21 10:42:54,581 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:42:54,585 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:42:54,590 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:42:54,600 (Thread-1): Acquiring new snowflake connection "xf_spotify_date".
2019-05-21 10:42:54,600 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:42:54,601 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:42:54,601 (Thread-1): On xf_spotify_date: BEGIN
2019-05-21 10:42:54,776 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 10:42:54,776 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:42:54,777 (Thread-1): On xf_spotify_date: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date as (
    --Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
  );
2019-05-21 10:42:55,195 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2019-05-21 10:42:55,196 (Thread-1): On xf_spotify_date: COMMIT
2019-05-21 10:42:55,196 (Thread-1): Using snowflake connection "xf_spotify_date".
2019-05-21 10:42:55,196 (Thread-1): On xf_spotify_date: COMMIT
2019-05-21 10:42:55,342 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:42:55,347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654422fe90>], 'label': '139bad55-1c3a-46e9-bec5-8a605806333a'}
2019-05-21 10:42:55,457 (Thread-1): 10:42:55 | 3 of 4 OK created view model GDELT_RAW.xf_spotify_date............... [SUCCESS 1 in 0.77s]
2019-05-21 10:42:55,459 (Thread-1): 10:42:55 | 4 of 4 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:42:55,459 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:42:55,462 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:42:55,467 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:42:55,468 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:42:55,468 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:42:55,469 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:42:55,469 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:42:55,618 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:42:55,618 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:42:55,618 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:42:56,251 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2019-05-21 10:42:56,252 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:42:56,252 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:42:56,252 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:42:56,478 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2019-05-21 10:42:56,482 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653a2ecb90>], 'label': '139bad55-1c3a-46e9-bec5-8a605806333a'}
2019-05-21 10:43:01,681 (Thread-1): 10:43:01 | 4 of 4 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 1.02s]
2019-05-21 10:43:01,749 (MainThread): 10:43:01 | 
2019-05-21 10:43:01,750 (MainThread): 10:43:01 | Finished running 4 view models in 15.17s.
2019-05-21 10:43:02,033 (MainThread): 
2019-05-21 10:43:02,034 (MainThread): Completed successfully
2019-05-21 10:43:02,034 (MainThread): 
Done. PASS=4 ERROR=0 SKIP=0 TOTAL=4
2019-05-21 10:43:02,034 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653bfb0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653bfce3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65436e3250>], 'label': 'end'}
2019-05-21 10:43:02,140 (MainThread): Flushing usage events
2019-05-21 10:44:25,301 (MainThread): Tracking: tracking
2019-05-21 10:44:25,301 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fc7d1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fc7d1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fc7d1810>], 'label': 'start'}
2019-05-21 10:44:25,467 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:44:25,473 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:44:25,475 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:44:25,476 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:44:25,483 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:44:25,486 (MainThread): Parsing macros/core.sql
2019-05-21 10:44:25,489 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:44:25,510 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:44:25,516 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:44:25,518 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:44:25,519 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:44:25,524 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:44:25,539 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:44:25,542 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:44:25,548 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:44:25,559 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:44:25,565 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:44:25,569 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:44:25,574 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:44:25,575 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:44:25,576 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:44:25,578 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:44:25,586 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:44:25,592 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:44:25,595 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:44:25,598 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:44:25,626 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:44:25,627 (MainThread): 
2019-05-21 10:44:25,627 (MainThread): 10:44:25 | Concurrency: 1 threads (target='dev')
2019-05-21 10:44:25,628 (MainThread): 10:44:25 | 
2019-05-21 10:44:25,631 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:44:25,633 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:44:25,639 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:44:25,670 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:44:25,675 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:44:25,679 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:44:25,682 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:44:25,685 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:44:25,737 (MainThread): 10:44:25 | Done.
2019-05-21 10:44:26,165 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:44:26,171 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:44:26,173 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:44:26,174 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:44:26,181 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:44:26,183 (MainThread): Parsing macros/core.sql
2019-05-21 10:44:26,186 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:44:26,207 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:44:26,213 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:44:26,214 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:44:26,216 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:44:26,221 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:44:26,235 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:44:26,238 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:44:26,245 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:44:26,255 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:44:26,261 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:44:26,265 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:44:26,270 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:44:26,271 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:44:26,272 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:44:26,273 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:44:26,283 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:44:26,286 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:44:26,289 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:44:26,292 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:44:26,306 (MainThread): 10:44:26 | Building catalog
2019-05-21 10:44:26,317 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:44:26,323 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:44:26,325 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:44:26,326 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:44:26,332 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:44:26,335 (MainThread): Parsing macros/core.sql
2019-05-21 10:44:26,338 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:44:26,359 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:44:26,365 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:44:26,367 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:44:26,368 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:44:26,373 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:44:26,388 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:44:26,391 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:44:26,397 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:44:26,408 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:44:26,413 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:44:26,418 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:44:26,423 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:44:26,424 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:44:26,425 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:44:26,426 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:44:26,485 (MainThread): Acquiring new snowflake connection "get_catalog".
2019-05-21 10:44:26,485 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:44:28,066 (MainThread): Using snowflake connection "get_catalog".
2019-05-21 10:44:28,066 (MainThread): On get_catalog: BEGIN
2019-05-21 10:44:28,315 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2019-05-21 10:44:28,316 (MainThread): Using snowflake connection "get_catalog".
2019-05-21 10:44:28,316 (MainThread): On get_catalog: (
            with tables as (

                select
                    table_catalog as "table_database",
                    table_schema as "table_schema",
                    table_name as "table_name",
                    table_type as "table_type",

                    -- note: this is the _role_ that owns the table
                    table_owner as "table_owner",

                    'Clustering Key' as "stats:clustering_key:label",
                    clustering_key as "stats:clustering_key:value",
                    'The key used to cluster this table' as "stats:clustering_key:description",
                    (clustering_key is not null) as "stats:clustering_key:include",

                    'Row Count' as "stats:row_count:label",
                    row_count as "stats:row_count:value",
                    'An approximate count of rows in this table' as "stats:row_count:description",
                    (row_count is not null) as "stats:row_count:include",

                    'Approximate Size' as "stats:bytes:label",
                    bytes as "stats:bytes:value",
                    'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
                    (bytes is not null) as "stats:bytes:include"

                from SB_HACKATHON_DB_TEAM1.information_schema.tables

            ),

            columns as (

                select
                    table_catalog as "table_database",
                    table_schema as "table_schema",
                    table_name as "table_name",
                    null as "table_comment",

                    column_name as "column_name",
                    ordinal_position as "column_index",
                    data_type as "column_type",
                    null as "column_comment"

                from SB_HACKATHON_DB_TEAM1.information_schema.columns

            )

            select *
            from tables
            join columns using ("table_database", "table_schema", "table_name")
            where "table_schema" != 'INFORMATION_SCHEMA'
            order by "column_index"
        )
2019-05-21 10:44:31,620 (MainThread): SQL status: SUCCESS 842 in 3.30 seconds
2019-05-21 10:44:32,255 (MainThread): On get_catalog: ROLLBACK
2019-05-21 10:44:32,547 (MainThread): 10:44:32 | Catalog written to /mnt/c/Users/vanna.trieu/Documents/dbt_projects/gdelt/target/catalog.json
2019-05-21 10:44:32,549 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44072da390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4403f4f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fc306910>], 'label': 'end'}
2019-05-21 10:44:32,731 (MainThread): Flushing usage events
2019-05-21 10:44:42,189 (MainThread): Tracking: tracking
2019-05-21 10:44:42,189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12e871f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12e871fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12e871f90>], 'label': 'start'}
2019-05-21 10:44:42,517 (MainThread): Serving docs at 0.0.0.0:8080
2019-05-21 10:44:42,518 (MainThread): To access from your browser, navigate to http://localhost:8080.
2019-05-21 10:44:42,518 (MainThread): Press Ctrl+C to exit.


2019-05-21 10:47:12,958 (MainThread): Flushing usage events
2019-05-21 10:47:12,958 (MainThread): ctrl-c
2019-05-21 10:47:17,870 (MainThread): Tracking: tracking
2019-05-21 10:47:17,871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b92d0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b92d0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01b92d0a90>], 'label': 'start'}
2019-05-21 10:47:18,008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01bb9a9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01bb10ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01bca9b690>], 'label': 'end'}
2019-05-21 10:47:18,200 (MainThread): Flushing usage events
2019-05-21 10:47:22,709 (MainThread): Tracking: tracking
2019-05-21 10:47:22,710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31f031690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31f031a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31f031810>], 'label': 'start'}
2019-05-21 10:47:22,921 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:47:22,927 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:47:22,929 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:47:22,930 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:47:22,937 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:47:22,940 (MainThread): Parsing macros/core.sql
2019-05-21 10:47:22,943 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:47:22,965 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:47:22,970 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:47:22,972 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:47:22,974 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:47:22,979 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:47:22,994 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:47:22,996 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:47:23,003 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:47:23,014 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:47:23,019 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:47:23,024 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:47:23,029 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:47:23,030 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:47:23,031 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:47:23,032 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:47:23,041 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:47:23,047 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:47:23,050 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:47:23,053 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:47:23,093 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:47:23,094 (MainThread): 
2019-05-21 10:47:23,094 (MainThread): 10:47:23 | Concurrency: 1 threads (target='dev')
2019-05-21 10:47:23,095 (MainThread): 10:47:23 | 
2019-05-21 10:47:23,097 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:47:23,100 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:47:23,106 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:47:23,142 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:47:23,148 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:47:23,154 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:47:23,159 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:47:23,165 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:47:23,206 (MainThread): 10:47:23 | Done.
2019-05-21 10:47:23,206 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31eb79d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3274cb090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31eb5ab10>], 'label': 'end'}
2019-05-21 10:47:23,368 (MainThread): Flushing usage events
2019-05-21 10:47:27,276 (MainThread): Tracking: tracking
2019-05-21 10:47:27,277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2683fd1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2683fd1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2683fd1810>], 'label': 'start'}
2019-05-21 10:47:27,491 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:47:27,497 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:47:27,499 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:47:27,500 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:47:27,506 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:47:27,509 (MainThread): Parsing macros/core.sql
2019-05-21 10:47:27,512 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:47:27,534 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:47:27,539 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:47:27,541 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:47:27,542 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:47:27,547 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:47:27,562 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:47:27,565 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:47:27,571 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:47:27,581 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:47:27,587 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:47:27,592 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:47:27,596 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:47:27,597 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:47:27,598 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:47:27,600 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:47:27,608 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:47:27,614 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:47:27,617 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:47:27,620 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:47:27,648 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:47:27,648 (MainThread): 
2019-05-21 10:47:27,687 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:47:27,694 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:47:27,696 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:47:27,696 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:47:27,703 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:47:27,705 (MainThread): Parsing macros/core.sql
2019-05-21 10:47:27,708 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:47:27,729 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:47:27,736 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:47:27,737 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:47:27,739 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:47:27,744 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:47:27,759 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:47:27,762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:47:27,768 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:47:27,778 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:47:27,784 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:47:27,789 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:47:27,793 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:47:27,795 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:47:27,796 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:47:27,797 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:47:27,860 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:47:27,860 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:47:29,418 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:47:29,418 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:47:29,613 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-21 10:47:29,614 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:47:29,614 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:47:31,341 (MainThread): SQL status: SUCCESS 56 in 1.73 seconds
2019-05-21 10:47:31,358 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:47:31,697 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:47:31,697 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:47:31,698 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:47:31,698 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:47:33,935 (MainThread): SQL status: SUCCESS 2 in 2.24 seconds
2019-05-21 10:47:33,936 (MainThread): 10:47:33 | Concurrency: 1 threads (target='dev')
2019-05-21 10:47:33,936 (MainThread): 10:47:33 | 
2019-05-21 10:47:33,938 (Thread-1): 10:47:33 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 10:47:33,939 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:47:33,942 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:47:33,967 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:47:33,969 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 10:47:33,970 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:47:33,970 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:47:33,970 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 10:47:34,160 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-21 10:47:34,160 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:47:34,160 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 10:47:34,602 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2019-05-21 10:47:34,603 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:47:34,603 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:47:34,603 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:47:34,762 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-21 10:47:34,767 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26823b8bd0>], 'label': '944a3fdc-b655-47ed-b73e-0aa86f47c2b6'}
2019-05-21 10:47:34,935 (Thread-1): 10:47:34 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 0.83s]
2019-05-21 10:47:34,936 (Thread-1): 10:47:34 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 10:47:34,937 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:47:34,941 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:47:34,947 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:47:34,949 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 10:47:34,949 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:47:34,950 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:47:34,950 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 10:47:35,121 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:47:35,121 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:47:35,121 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 10:47:35,507 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2019-05-21 10:47:35,508 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:47:35,508 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:47:35,508 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:47:35,640 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-21 10:47:35,644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26823b8950>], 'label': '944a3fdc-b655-47ed-b73e-0aa86f47c2b6'}
2019-05-21 10:47:35,801 (Thread-1): 10:47:35 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.71s]
2019-05-21 10:47:35,802 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:47:35,806 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:47:35,810 (Thread-1): 10:47:35 | 3 of 3 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:47:35,810 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:47:35,815 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:47:35,820 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:47:35,829 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:47:35,830 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:47:35,831 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:47:35,831 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:47:36,026 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2019-05-21 10:47:36,026 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:47:36,027 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    with __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
)--aggregating xf_spotify_date

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
from __dbt__CTE__xf_spotify_date
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:47:36,424 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2019-05-21 10:47:36,425 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:47:36,425 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:47:36,425 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:47:36,573 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-21 10:47:36,578 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2682338650>], 'label': '944a3fdc-b655-47ed-b73e-0aa86f47c2b6'}
2019-05-21 10:47:36,792 (Thread-1): 10:47:36 | 3 of 3 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 0.77s]
2019-05-21 10:47:36,856 (MainThread): 10:47:36 | 
2019-05-21 10:47:36,857 (MainThread): 10:47:36 | Finished running 3 view models in 9.21s.
2019-05-21 10:47:37,110 (MainThread): 
2019-05-21 10:47:37,110 (MainThread): Completed successfully
2019-05-21 10:47:37,110 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-05-21 10:47:37,111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2683ff0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f268400e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f268b718750>], 'label': 'end'}
2019-05-21 10:47:37,268 (MainThread): Flushing usage events
2019-05-21 10:57:11,946 (MainThread): Tracking: tracking
2019-05-21 10:57:11,951 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2032090410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2032090e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2032090a90>], 'label': 'start'}
2019-05-21 10:57:12,133 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2034769210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2037f9d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203585b690>], 'label': 'end'}
2019-05-21 10:57:12,302 (MainThread): Flushing usage events
2019-05-21 10:57:22,457 (MainThread): Tracking: tracking
2019-05-21 10:57:22,457 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb855731690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb855731a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb855731810>], 'label': 'start'}
2019-05-21 10:57:22,645 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:57:22,656 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:57:22,661 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:57:22,666 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:57:22,676 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:57:22,683 (MainThread): Parsing macros/core.sql
2019-05-21 10:57:22,691 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:57:22,717 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:57:22,726 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:57:22,732 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:57:22,737 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:57:22,746 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:57:22,765 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:57:22,772 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:57:22,783 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:57:22,798 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:57:22,808 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:57:22,817 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:57:22,826 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:57:22,831 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:57:22,836 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:57:22,840 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:57:22,856 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:57:22,861 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:57:22,864 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:57:22,868 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:57:22,903 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:57:22,904 (MainThread): 
2019-05-21 10:57:22,905 (MainThread): 10:57:22 | Concurrency: 1 threads (target='dev')
2019-05-21 10:57:22,905 (MainThread): 10:57:22 | 
2019-05-21 10:57:22,907 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:57:22,910 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:57:22,916 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:57:22,948 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:57:22,953 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:57:22,958 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:57:22,963 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:57:22,971 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:57:23,014 (MainThread): 10:57:23 | Done.
2019-05-21 10:57:23,014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb85dbcb090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb855279b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb855279390>], 'label': 'end'}
2019-05-21 10:57:23,191 (MainThread): Flushing usage events
2019-05-21 10:57:28,800 (MainThread): Tracking: tracking
2019-05-21 10:57:28,800 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19240f1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19240f1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19240f1810>], 'label': 'start'}
2019-05-21 10:57:29,006 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:57:29,012 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:57:29,014 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:57:29,015 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:57:29,022 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:57:29,025 (MainThread): Parsing macros/core.sql
2019-05-21 10:57:29,027 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:57:29,051 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:57:29,058 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:57:29,060 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:57:29,061 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:57:29,067 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:57:29,082 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:57:29,085 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:57:29,092 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:57:29,104 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:57:29,110 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:57:29,114 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:57:29,119 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:57:29,121 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:57:29,122 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:57:29,123 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:57:29,132 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:57:29,138 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:57:29,141 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:57:29,144 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:57:29,172 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:57:29,173 (MainThread): 
2019-05-21 10:57:29,214 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:57:29,219 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:57:29,221 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:57:29,222 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:57:29,229 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:57:29,231 (MainThread): Parsing macros/core.sql
2019-05-21 10:57:29,234 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:57:29,256 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:57:29,263 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:57:29,264 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:57:29,266 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:57:29,271 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:57:29,288 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:57:29,292 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:57:29,299 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:57:29,309 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:57:29,315 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:57:29,320 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:57:29,325 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:57:29,326 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:57:29,327 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:57:29,328 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:57:29,394 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:57:29,394 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:57:31,571 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:57:31,571 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:57:31,737 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 10:57:31,737 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:57:31,737 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:57:35,376 (MainThread): SQL status: SUCCESS 59 in 3.64 seconds
2019-05-21 10:57:35,393 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:57:35,768 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:57:35,768 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:57:35,768 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:57:35,768 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:57:37,642 (MainThread): SQL status: SUCCESS 2 in 1.87 seconds
2019-05-21 10:57:37,643 (MainThread): 10:57:37 | Concurrency: 1 threads (target='dev')
2019-05-21 10:57:37,643 (MainThread): 10:57:37 | 
2019-05-21 10:57:37,645 (Thread-1): 10:57:37 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 10:57:37,646 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 10:57:37,649 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:57:37,673 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 10:57:37,677 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 10:57:37,677 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:57:37,678 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:57:37,678 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 10:57:37,865 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-21 10:57:37,865 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:57:37,865 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model

select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 10:57:38,213 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2019-05-21 10:57:38,214 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:57:38,214 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 10:57:38,214 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 10:57:38,550 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2019-05-21 10:57:38,555 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19224d2c50>], 'label': '48c6f651-b8a0-4c3b-8e1c-df7ffa6ce82e'}
2019-05-21 10:57:38,650 (Thread-1): 10:57:38 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 0.91s]
2019-05-21 10:57:38,651 (Thread-1): 10:57:38 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 10:57:38,651 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 10:57:38,656 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:57:38,660 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 10:57:38,664 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 10:57:38,664 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:57:38,665 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:57:38,665 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 10:57:38,882 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2019-05-21 10:57:38,882 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:57:38,883 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 10:57:39,415 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2019-05-21 10:57:39,416 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:57:39,416 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 10:57:39,416 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 10:57:39,542 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-21 10:57:39,547 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19224d2550>], 'label': '48c6f651-b8a0-4c3b-8e1c-df7ffa6ce82e'}
2019-05-21 10:57:39,674 (Thread-1): 10:57:39 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.90s]
2019-05-21 10:57:39,675 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:57:39,679 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:57:39,683 (Thread-1): 10:57:39 | 3 of 3 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:57:39,683 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:57:39,692 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:57:39,696 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:57:39,701 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:57:39,701 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:57:39,702 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:57:39,702 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:57:39,886 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 10:57:39,886 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:57:39,886 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

with  __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
),SPOTIFY_STOCK_DATA as 
(
    select * from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data
),

SPOTIFY_STOCK_DATE as
(
    select * from __dbt__CTE__xf_spotify_date
)

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
    , DTA.*
from SPOTIFY_STOCK_DATE DT  left join SPOTIFY_STOCK_DATA DTA on DT.Date_Added = DTA."Date"
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:57:41,017 (Thread-1): Snowflake error: 001104 (42601): 018c55a1-03ba-64f4-0000-090100774c86: SQL compilation error: error line 0 at position -1
'SYS_VW."Date_0"' in select clause is neither an aggregate nor in the group by clause.
2019-05-21 10:57:41,017 (Thread-1): On xf_spotify_aggregated: ROLLBACK
2019-05-21 10:57:41,210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19224d2bd0>], 'label': '48c6f651-b8a0-4c3b-8e1c-df7ffa6ce82e'}
2019-05-21 10:57:41,358 (Thread-1): 10:57:41 | 3 of 3 ERROR creating view model GDELT_RAW.xf_spotify_aggregated..... [ERROR in 1.53s]
2019-05-21 10:57:41,365 (MainThread): 10:57:41 | 
2019-05-21 10:57:41,365 (MainThread): 10:57:41 | Finished running 3 view models in 12.19s.
2019-05-21 10:57:41,651 (MainThread): 
2019-05-21 10:57:41,651 (MainThread): Completed with 1 errors:
2019-05-21 10:57:41,652 (MainThread): 
2019-05-21 10:57:41,652 (MainThread): Database Error in model xf_spotify_aggregated (models/xf/xf_spotify_aggregated.sql)
2019-05-21 10:57:41,652 (MainThread):   001104 (42601): 018c55a1-03ba-64f4-0000-090100774c86: SQL compilation error: error line 0 at position -1
2019-05-21 10:57:41,653 (MainThread):   'SYS_VW."Date_0"' in select clause is neither an aggregate nor in the group by clause.
2019-05-21 10:57:41,653 (MainThread):   compiled SQL at target/compiled/gdelt/xf/xf_spotify_aggregated.sql
2019-05-21 10:57:41,654 (MainThread): 
Done. PASS=2 ERROR=1 SKIP=0 TOTAL=3
2019-05-21 10:57:41,657 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1924110bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f192412e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1922b9c5d0>], 'label': 'end'}
2019-05-21 10:57:41,837 (MainThread): Flushing usage events
2019-05-21 10:59:25,382 (MainThread): Tracking: tracking
2019-05-21 10:59:25,382 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d27132850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d27132b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d27132ad0>], 'label': 'start'}
2019-05-21 10:59:25,537 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:59:25,544 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:59:25,546 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:59:25,548 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:59:25,554 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:59:25,557 (MainThread): Parsing macros/core.sql
2019-05-21 10:59:25,561 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:59:25,582 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:59:25,587 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:59:25,589 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:59:25,590 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:59:25,595 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:59:25,610 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:59:25,612 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:59:25,619 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:59:25,629 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:59:25,634 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:59:25,639 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:59:25,644 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:59:25,645 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:59:25,646 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:59:25,647 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:59:25,656 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 10:59:25,662 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 10:59:25,665 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 10:59:25,668 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 10:59:25,698 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 10:59:25,699 (MainThread): 
2019-05-21 10:59:25,740 (MainThread): Parsing macros/adapters.sql
2019-05-21 10:59:25,746 (MainThread): Parsing macros/catalog.sql
2019-05-21 10:59:25,748 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 10:59:25,749 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 10:59:25,755 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 10:59:25,757 (MainThread): Parsing macros/core.sql
2019-05-21 10:59:25,760 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 10:59:25,782 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 10:59:25,787 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 10:59:25,789 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 10:59:25,790 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 10:59:25,795 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 10:59:25,810 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 10:59:25,812 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 10:59:25,819 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 10:59:25,829 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 10:59:25,835 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 10:59:25,840 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 10:59:25,844 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 10:59:25,846 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 10:59:25,846 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 10:59:25,848 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 10:59:25,911 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 10:59:25,912 (MainThread): Opening a new connection, currently in state init
2019-05-21 10:59:27,673 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:59:27,673 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 10:59:27,908 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2019-05-21 10:59:27,909 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 10:59:27,909 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 10:59:29,591 (MainThread): SQL status: SUCCESS 59 in 1.68 seconds
2019-05-21 10:59:29,599 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 10:59:29,928 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 10:59:29,928 (MainThread): Re-using an available connection from the pool.
2019-05-21 10:59:29,929 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 10:59:29,929 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 10:59:31,606 (MainThread): SQL status: SUCCESS 2 in 1.68 seconds
2019-05-21 10:59:31,607 (MainThread): 10:59:31 | Concurrency: 1 threads (target='dev')
2019-05-21 10:59:31,607 (MainThread): 10:59:31 | 
2019-05-21 10:59:31,610 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 10:59:31,614 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 10:59:31,621 (Thread-1): 10:59:31 | 1 of 1 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 10:59:31,622 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 10:59:31,637 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:59:31,668 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 10:59:31,671 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 10:59:31,671 (Thread-1): Re-using an available connection from the pool.
2019-05-21 10:59:31,672 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:59:31,673 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 10:59:31,850 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 10:59:31,850 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:59:31,850 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date

with  __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
),SPOTIFY_STOCK_DATA as 
(
    select * from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data
),

SPOTIFY_STOCK_DATE as
(
    select * from __dbt__CTE__xf_spotify_date
)

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
    , avg(Open) as "Open"
    , avg(Close) as "Close"
from SPOTIFY_STOCK_DATE DT  left join SPOTIFY_STOCK_DATA DTA on DT.Date_Added = DTA."Date"
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 10:59:32,384 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2019-05-21 10:59:32,385 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:59:32,385 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 10:59:32,385 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 10:59:32,525 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-21 10:59:32,530 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2551abd0>], 'label': '89d5089d-3351-4c71-8752-938ffee402cc'}
2019-05-21 10:59:32,652 (Thread-1): 10:59:32 | 1 of 1 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 0.91s]
2019-05-21 10:59:32,714 (MainThread): 10:59:32 | 
2019-05-21 10:59:32,715 (MainThread): 10:59:32 | Finished running 1 view models in 7.01s.
2019-05-21 10:59:32,996 (MainThread): 
2019-05-21 10:59:32,997 (MainThread): Completed successfully
2019-05-21 10:59:32,998 (MainThread): 
Done. PASS=1 ERROR=0 SKIP=0 TOTAL=1
2019-05-21 10:59:33,002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d27150f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2716e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d25bedd10>], 'label': 'end'}
2019-05-21 10:59:33,129 (MainThread): Flushing usage events
2019-05-21 11:02:35,763 (MainThread): Tracking: tracking
2019-05-21 11:02:35,763 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050cdd0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050cdd0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050cdd0a90>], 'label': 'start'}
2019-05-21 11:02:35,901 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050f4a9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0512cdd350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051059b690>], 'label': 'end'}
2019-05-21 11:02:36,074 (MainThread): Flushing usage events
2019-05-21 11:02:51,786 (MainThread): Tracking: tracking
2019-05-21 11:02:51,786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c331690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c331a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c331810>], 'label': 'start'}
2019-05-21 11:02:52,006 (MainThread): Parsing macros/adapters.sql
2019-05-21 11:02:52,012 (MainThread): Parsing macros/catalog.sql
2019-05-21 11:02:52,014 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 11:02:52,014 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 11:02:52,021 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 11:02:52,024 (MainThread): Parsing macros/core.sql
2019-05-21 11:02:52,028 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 11:02:52,050 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 11:02:52,055 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 11:02:52,057 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 11:02:52,059 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 11:02:52,065 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 11:02:52,080 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 11:02:52,083 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 11:02:52,090 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 11:02:52,101 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 11:02:52,106 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 11:02:52,111 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 11:02:52,116 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 11:02:52,117 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 11:02:52,118 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 11:02:52,120 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 11:02:52,129 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 11:02:52,135 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 11:02:52,137 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 11:02:52,141 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 11:02:52,170 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 11:02:52,171 (MainThread): 
2019-05-21 11:02:52,172 (MainThread): 11:02:52 | Concurrency: 1 threads (target='dev')
2019-05-21 11:02:52,172 (MainThread): 11:02:52 | 
2019-05-21 11:02:52,174 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 11:02:52,177 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 11:02:52,181 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 11:02:52,212 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 11:02:52,215 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 11:02:52,220 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 11:02:52,224 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 11:02:52,235 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 11:02:52,281 (MainThread): 11:02:52 | Done.
2019-05-21 11:02:52,702 (MainThread): Parsing macros/adapters.sql
2019-05-21 11:02:52,707 (MainThread): Parsing macros/catalog.sql
2019-05-21 11:02:52,709 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 11:02:52,710 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 11:02:52,717 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 11:02:52,719 (MainThread): Parsing macros/core.sql
2019-05-21 11:02:52,722 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 11:02:52,744 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 11:02:52,751 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 11:02:52,753 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 11:02:52,754 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 11:02:52,759 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 11:02:52,774 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 11:02:52,776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 11:02:52,783 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 11:02:52,794 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 11:02:52,799 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 11:02:52,804 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 11:02:52,809 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 11:02:52,810 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 11:02:52,811 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 11:02:52,812 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 11:02:52,821 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 11:02:52,824 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 11:02:52,827 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 11:02:52,830 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 11:02:52,845 (MainThread): 11:02:52 | Building catalog
2019-05-21 11:02:52,856 (MainThread): Parsing macros/adapters.sql
2019-05-21 11:02:52,861 (MainThread): Parsing macros/catalog.sql
2019-05-21 11:02:52,863 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 11:02:52,864 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 11:02:52,870 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 11:02:52,873 (MainThread): Parsing macros/core.sql
2019-05-21 11:02:52,876 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 11:02:52,897 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 11:02:52,903 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 11:02:52,904 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 11:02:52,906 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 11:02:52,911 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 11:02:52,925 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 11:02:52,928 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 11:02:52,935 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 11:02:52,945 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 11:02:52,951 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 11:02:52,956 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 11:02:52,961 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 11:02:52,962 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 11:02:52,963 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 11:02:52,964 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 11:02:53,023 (MainThread): Acquiring new snowflake connection "get_catalog".
2019-05-21 11:02:53,023 (MainThread): Opening a new connection, currently in state init
2019-05-21 11:02:54,630 (MainThread): Using snowflake connection "get_catalog".
2019-05-21 11:02:54,631 (MainThread): On get_catalog: BEGIN
2019-05-21 11:02:54,839 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2019-05-21 11:02:54,839 (MainThread): Using snowflake connection "get_catalog".
2019-05-21 11:02:54,839 (MainThread): On get_catalog: (
            with tables as (

                select
                    table_catalog as "table_database",
                    table_schema as "table_schema",
                    table_name as "table_name",
                    table_type as "table_type",

                    -- note: this is the _role_ that owns the table
                    table_owner as "table_owner",

                    'Clustering Key' as "stats:clustering_key:label",
                    clustering_key as "stats:clustering_key:value",
                    'The key used to cluster this table' as "stats:clustering_key:description",
                    (clustering_key is not null) as "stats:clustering_key:include",

                    'Row Count' as "stats:row_count:label",
                    row_count as "stats:row_count:value",
                    'An approximate count of rows in this table' as "stats:row_count:description",
                    (row_count is not null) as "stats:row_count:include",

                    'Approximate Size' as "stats:bytes:label",
                    bytes as "stats:bytes:value",
                    'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
                    (bytes is not null) as "stats:bytes:include"

                from SB_HACKATHON_DB_TEAM1.information_schema.tables

            ),

            columns as (

                select
                    table_catalog as "table_database",
                    table_schema as "table_schema",
                    table_name as "table_name",
                    null as "table_comment",

                    column_name as "column_name",
                    ordinal_position as "column_index",
                    data_type as "column_type",
                    null as "column_comment"

                from SB_HACKATHON_DB_TEAM1.information_schema.columns

            )

            select *
            from tables
            join columns using ("table_database", "table_schema", "table_name")
            where "table_schema" != 'INFORMATION_SCHEMA'
            order by "column_index"
        )
2019-05-21 11:02:58,089 (MainThread): SQL status: SUCCESS 838 in 3.25 seconds
2019-05-21 11:02:58,726 (MainThread): On get_catalog: ROLLBACK
2019-05-21 11:02:59,005 (MainThread): 11:02:59 | Catalog written to /mnt/c/Users/vanna.trieu/Documents/dbt_projects/gdelt/target/catalog.json
2019-05-21 11:02:59,006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033aaf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033a8a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033a83050>], 'label': 'end'}
2019-05-21 11:02:59,175 (MainThread): Flushing usage events
2019-05-21 11:03:04,469 (MainThread): Tracking: tracking
2019-05-21 11:03:04,469 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a40f31f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a40f31fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a40f31f90>], 'label': 'start'}
2019-05-21 11:03:04,781 (MainThread): Serving docs at 0.0.0.0:8080
2019-05-21 11:03:04,782 (MainThread): To access from your browser, navigate to http://localhost:8080.
2019-05-21 11:03:04,782 (MainThread): Press Ctrl+C to exit.


2019-05-21 11:03:42,430 (MainThread): Flushing usage events
2019-05-21 11:03:42,431 (MainThread): ctrl-c
2019-05-21 11:07:13,444 (MainThread): Tracking: tracking
2019-05-21 11:07:13,444 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb86790410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb86790e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb86790a90>], 'label': 'start'}
2019-05-21 11:07:13,615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb88e69210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb89f5b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8c6cd350>], 'label': 'end'}
2019-05-21 11:07:13,706 (MainThread): Flushing usage events
2019-05-21 11:07:18,268 (MainThread): Tracking: tracking
2019-05-21 11:07:18,268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38f211690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38f211a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38f211810>], 'label': 'start'}
2019-05-21 11:07:18,489 (MainThread): Parsing macros/adapters.sql
2019-05-21 11:07:18,495 (MainThread): Parsing macros/catalog.sql
2019-05-21 11:07:18,496 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 11:07:18,497 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 11:07:18,504 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 11:07:18,507 (MainThread): Parsing macros/core.sql
2019-05-21 11:07:18,510 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 11:07:18,532 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 11:07:18,538 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 11:07:18,539 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 11:07:18,541 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 11:07:18,546 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 11:07:18,561 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 11:07:18,564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 11:07:18,571 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 11:07:18,581 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 11:07:18,587 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 11:07:18,591 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 11:07:18,596 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 11:07:18,597 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 11:07:18,598 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 11:07:18,599 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 11:07:18,608 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 11:07:18,614 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 11:07:18,617 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 11:07:18,620 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 11:07:18,651 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 11:07:18,652 (MainThread): 
2019-05-21 11:07:18,652 (MainThread): 11:07:18 | Concurrency: 1 threads (target='dev')
2019-05-21 11:07:18,652 (MainThread): 11:07:18 | 
2019-05-21 11:07:18,655 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 11:07:18,658 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 11:07:18,664 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 11:07:18,696 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 11:07:18,699 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 11:07:18,704 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 11:07:18,708 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 11:07:18,716 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 11:07:18,763 (MainThread): 11:07:18 | Done.
2019-05-21 11:07:18,763 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3976ab090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38ed3a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc38ed3ab10>], 'label': 'end'}
2019-05-21 11:07:18,903 (MainThread): Flushing usage events
2019-05-21 11:07:22,894 (MainThread): Tracking: tracking
2019-05-21 11:07:22,894 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb33471690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb33471a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb33471810>], 'label': 'start'}
2019-05-21 11:07:23,035 (MainThread): Parsing macros/adapters.sql
2019-05-21 11:07:23,043 (MainThread): Parsing macros/catalog.sql
2019-05-21 11:07:23,045 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 11:07:23,046 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 11:07:23,054 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 11:07:23,057 (MainThread): Parsing macros/core.sql
2019-05-21 11:07:23,060 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 11:07:23,094 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 11:07:23,100 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 11:07:23,104 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 11:07:23,106 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 11:07:23,112 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 11:07:23,130 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 11:07:23,133 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 11:07:23,142 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 11:07:23,154 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 11:07:23,163 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 11:07:23,170 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 11:07:23,176 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 11:07:23,178 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 11:07:23,179 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 11:07:23,181 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 11:07:23,193 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-21 11:07:23,199 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-21 11:07:23,204 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-21 11:07:23,210 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-21 11:07:23,247 (MainThread): Found 95 macros, 0 analyses, 0 archives, 0 sources, 0 seed files, 0 tests, 0 operations, 4 models
2019-05-21 11:07:23,249 (MainThread): 
2019-05-21 11:07:23,299 (MainThread): Parsing macros/adapters.sql
2019-05-21 11:07:23,310 (MainThread): Parsing macros/catalog.sql
2019-05-21 11:07:23,312 (MainThread): Parsing macros/materializations/merge.sql
2019-05-21 11:07:23,313 (MainThread): Parsing macros/materializations/table.sql
2019-05-21 11:07:23,324 (MainThread): Parsing macros/materializations/view.sql
2019-05-21 11:07:23,328 (MainThread): Parsing macros/core.sql
2019-05-21 11:07:23,331 (MainThread): Parsing macros/adapters/common.sql
2019-05-21 11:07:23,360 (MainThread): Parsing macros/etc/datetime.sql
2019-05-21 11:07:23,366 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-21 11:07:23,369 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-21 11:07:23,371 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-21 11:07:23,378 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-21 11:07:23,395 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-21 11:07:23,398 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-21 11:07:23,409 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-21 11:07:23,422 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-21 11:07:23,428 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-21 11:07:23,433 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-21 11:07:23,441 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-21 11:07:23,443 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-21 11:07:23,444 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-21 11:07:23,445 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-21 11:07:23,529 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-21 11:07:23,529 (MainThread): Opening a new connection, currently in state init
2019-05-21 11:07:25,191 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 11:07:25,191 (MainThread): On list_relations_without_caching: BEGIN
2019-05-21 11:07:25,368 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 11:07:25,368 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-21 11:07:25,368 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-21 11:07:27,370 (MainThread): SQL status: SUCCESS 59 in 2.00 seconds
2019-05-21 11:07:27,388 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-21 11:07:27,783 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-21 11:07:27,783 (MainThread): Re-using an available connection from the pool.
2019-05-21 11:07:27,783 (MainThread): Using snowflake connection "list_schemas".
2019-05-21 11:07:27,783 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name='SB_HACKATHON_DB_TEAM1'
2019-05-21 11:07:29,709 (MainThread): SQL status: SUCCESS 2 in 1.93 seconds
2019-05-21 11:07:29,709 (MainThread): 11:07:29 | Concurrency: 1 threads (target='dev')
2019-05-21 11:07:29,710 (MainThread): 11:07:29 | 
2019-05-21 11:07:29,711 (Thread-1): 11:07:29 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-21 11:07:29,712 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-21 11:07:29,715 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 11:07:29,738 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-21 11:07:29,743 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-21 11:07:29,743 (Thread-1): Re-using an available connection from the pool.
2019-05-21 11:07:29,743 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 11:07:29,744 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-21 11:07:29,900 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-21 11:07:29,901 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 11:07:29,901 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model



select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-21 11:07:30,344 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2019-05-21 11:07:30,345 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 11:07:30,345 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-21 11:07:30,345 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-21 11:07:30,481 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-21 11:07:30,486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb317d2350>], 'label': 'dd39516b-168e-4597-9771-377da594ffe6'}
2019-05-21 11:07:30,646 (Thread-1): 11:07:30 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 0.77s]
2019-05-21 11:07:30,646 (Thread-1): 11:07:30 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-21 11:07:30,647 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-21 11:07:30,651 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 11:07:30,656 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-21 11:07:30,657 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-21 11:07:30,658 (Thread-1): Re-using an available connection from the pool.
2019-05-21 11:07:30,658 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 11:07:30,658 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-21 11:07:30,824 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-21 11:07:30,824 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 11:07:30,824 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-21 11:07:31,511 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2019-05-21 11:07:31,512 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 11:07:31,512 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-21 11:07:31,512 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-21 11:07:31,644 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-21 11:07:31,655 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb31f1d590>], 'label': 'dd39516b-168e-4597-9771-377da594ffe6'}
2019-05-21 11:07:31,842 (Thread-1): 11:07:31 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 1.01s]
2019-05-21 11:07:31,842 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-21 11:07:31,849 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-21 11:07:31,852 (Thread-1): 11:07:31 | 3 of 3 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-21 11:07:31,852 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-21 11:07:31,861 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 11:07:31,866 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-21 11:07:31,879 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-21 11:07:31,879 (Thread-1): Re-using an available connection from the pool.
2019-05-21 11:07:31,880 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 11:07:31,880 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-21 11:07:32,059 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-21 11:07:32,059 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 11:07:32,059 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date



with  __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
),SPOTIFY_STOCK_DATA as 
(
    select * from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data
),

SPOTIFY_STOCK_DATE as
(
    select * from __dbt__CTE__xf_spotify_date
)

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
    , avg(Open) as "Open"
    , avg(Close) as "Close"
from SPOTIFY_STOCK_DATE DT  left join SPOTIFY_STOCK_DATA DTA on DT.Date_Added = DTA."Date"
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-21 11:07:32,704 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2019-05-21 11:07:32,705 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 11:07:32,705 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-21 11:07:32,705 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-21 11:07:32,837 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-21 11:07:32,842 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb31f0fa90>], 'label': 'dd39516b-168e-4597-9771-377da594ffe6'}
2019-05-21 11:07:32,935 (Thread-1): 11:07:32 | 3 of 3 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 0.99s]
2019-05-21 11:07:33,030 (MainThread): 11:07:33 | 
2019-05-21 11:07:33,031 (MainThread): 11:07:33 | Finished running 3 view models in 9.78s.
2019-05-21 11:07:33,272 (MainThread): 
2019-05-21 11:07:33,273 (MainThread): Completed successfully
2019-05-21 11:07:33,273 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-05-21 11:07:33,273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3348fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3ab40350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3b70fe50>], 'label': 'end'}
2019-05-21 11:07:33,490 (MainThread): Flushing usage events
2019-05-23 15:59:33,704 (MainThread): Tracking: tracking
2019-05-23 15:59:33,719 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa067bca58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa067bc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa067bcdd8>]}
2019-05-23 15:59:33,904 (MainThread): Checking target/*
2019-05-23 15:59:33,906 (MainThread):  Cleaned target/*
2019-05-23 15:59:33,907 (MainThread): Checking dbt_modules/*
2019-05-23 15:59:33,907 (MainThread):  Cleaned dbt_modules/*
2019-05-23 15:59:33,907 (MainThread): Finished cleaning all paths.
2019-05-23 15:59:33,907 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e16128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e58c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa067bc940>]}
2019-05-23 15:59:33,991 (MainThread): Flushing usage events
2019-05-23 15:59:54,151 (MainThread): Tracking: tracking
2019-05-23 15:59:54,152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d38c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967ce48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967ca90>]}
2019-05-23 15:59:54,271 (MainThread): Parsing macros/core.sql
2019-05-23 15:59:54,278 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 15:59:54,286 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 15:59:54,300 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 15:59:54,309 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 15:59:54,329 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 15:59:54,332 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 15:59:54,339 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 15:59:54,345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 15:59:54,351 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 15:59:54,353 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 15:59:54,359 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 15:59:54,362 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 15:59:54,387 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 15:59:54,388 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 15:59:54,390 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 15:59:54,391 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 15:59:54,393 (MainThread): Parsing macros/catalog.sql
2019-05-23 15:59:54,395 (MainThread): Parsing macros/adapters.sql
2019-05-23 15:59:54,401 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 15:59:54,402 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 15:59:54,403 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 15:59:54,420 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-23 15:59:54,430 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-23 15:59:54,433 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-23 15:59:54,437 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-23 15:59:54,455 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-23 15:59:54,456 (MainThread): 
2019-05-23 15:59:54,456 (MainThread): 15:59:54 | Concurrency: 1 threads (target='dev')
2019-05-23 15:59:54,456 (MainThread): 15:59:54 | 
2019-05-23 15:59:54,457 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-23 15:59:54,460 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-23 15:59:54,462 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-23 15:59:54,465 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-23 15:59:54,467 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-23 15:59:54,470 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-23 15:59:54,473 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-23 15:59:54,482 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-23 15:59:54,567 (MainThread): 15:59:54 | Done.
2019-05-23 15:59:54,567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33f2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33f208>]}
2019-05-23 15:59:54,665 (MainThread): Flushing usage events
2019-05-23 16:01:16,268 (MainThread): Tracking: tracking
2019-05-23 16:01:16,269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfede48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfeda90>]}
2019-05-23 16:01:16,468 (MainThread): Parsing macros/core.sql
2019-05-23 16:01:16,473 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 16:01:16,479 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 16:01:16,494 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 16:01:16,502 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 16:01:16,521 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 16:01:16,524 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 16:01:16,531 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 16:01:16,537 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 16:01:16,543 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 16:01:16,545 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 16:01:16,551 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 16:01:16,553 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 16:01:16,578 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 16:01:16,580 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 16:01:16,581 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 16:01:16,582 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 16:01:16,584 (MainThread): Parsing macros/catalog.sql
2019-05-23 16:01:16,586 (MainThread): Parsing macros/adapters.sql
2019-05-23 16:01:16,592 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 16:01:16,593 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 16:01:16,594 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 16:01:16,609 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-23 16:01:16,617 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-23 16:01:16,621 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-23 16:01:16,624 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-23 16:01:16,641 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-23 16:01:16,642 (MainThread): 
2019-05-23 16:01:16,654 (MainThread): Parsing macros/core.sql
2019-05-23 16:01:16,657 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 16:01:16,663 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 16:01:16,675 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 16:01:16,683 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 16:01:16,700 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 16:01:16,704 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 16:01:16,711 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 16:01:16,718 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 16:01:16,724 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 16:01:16,726 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 16:01:16,734 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 16:01:16,737 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 16:01:16,766 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 16:01:16,767 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 16:01:16,768 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 16:01:16,769 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 16:01:16,771 (MainThread): Parsing macros/catalog.sql
2019-05-23 16:01:16,773 (MainThread): Parsing macros/adapters.sql
2019-05-23 16:01:16,780 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 16:01:16,781 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 16:01:16,782 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 16:01:16,869 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-23 16:01:16,870 (MainThread): Opening a new connection, currently in state init
2019-05-23 16:01:17,249 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-05-23 16:01:17,264 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-05-23 16:01:17,890 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-23 16:01:17,891 (MainThread): On list_relations_without_caching: BEGIN
2019-05-23 16:01:18,120 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2019-05-23 16:01:18,120 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-23 16:01:18,120 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-23 16:01:23,068 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-23 16:01:23,882 (MainThread): Flushing usage events
2019-05-23 16:01:23,883 (MainThread): ctrl-c
2019-05-23 16:01:23,885 (MainThread): /anaconda3/lib/python3.6/site-packages/dbt/main.py:87: ResourceWarning: unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.5.28.109', 54391), raddr=('18.236.60.97', 443)>

2019-05-23 16:01:32,165 (MainThread): Tracking: tracking
2019-05-23 16:01:32,165 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111979be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142bbdd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142bba20>]}
2019-05-23 16:01:32,287 (MainThread): Parsing macros/core.sql
2019-05-23 16:01:32,292 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 16:01:32,299 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 16:01:32,313 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 16:01:32,323 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 16:01:32,344 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 16:01:32,347 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 16:01:32,354 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 16:01:32,360 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 16:01:32,365 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 16:01:32,366 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 16:01:32,373 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 16:01:32,375 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 16:01:32,398 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 16:01:32,400 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 16:01:32,401 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 16:01:32,402 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 16:01:32,403 (MainThread): Parsing macros/catalog.sql
2019-05-23 16:01:32,405 (MainThread): Parsing macros/adapters.sql
2019-05-23 16:01:32,412 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 16:01:32,412 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 16:01:32,413 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 16:01:32,427 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-23 16:01:32,435 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-23 16:01:32,439 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-23 16:01:32,442 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-23 16:01:32,459 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-23 16:01:32,460 (MainThread): 
2019-05-23 16:01:32,472 (MainThread): Parsing macros/core.sql
2019-05-23 16:01:32,475 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 16:01:32,481 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 16:01:32,494 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 16:01:32,502 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 16:01:32,522 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 16:01:32,526 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 16:01:32,533 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 16:01:32,539 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 16:01:32,545 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 16:01:32,546 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 16:01:32,552 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 16:01:32,554 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 16:01:32,578 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 16:01:32,579 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 16:01:32,580 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 16:01:32,581 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 16:01:32,583 (MainThread): Parsing macros/catalog.sql
2019-05-23 16:01:32,585 (MainThread): Parsing macros/adapters.sql
2019-05-23 16:01:32,591 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 16:01:32,592 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 16:01:32,593 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 16:01:32,676 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-23 16:01:32,676 (MainThread): Opening a new connection, currently in state init
2019-05-23 16:01:32,995 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-05-23 16:01:33,009 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-05-23 16:01:33,418 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-23 16:01:33,418 (MainThread): On list_relations_without_caching: BEGIN
2019-05-23 16:01:33,634 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2019-05-23 16:01:33,634 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-23 16:01:33,635 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-23 16:04:02,116 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-23 16:04:02,859 (MainThread): Flushing usage events
2019-05-23 16:04:02,859 (MainThread): ctrl-c
2019-05-23 16:04:02,861 (MainThread): /anaconda3/lib/python3.6/site-packages/dbt/main.py:87: ResourceWarning: unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.5.28.109', 54397), raddr=('54.186.187.212', 443)>

2019-05-23 16:04:55,580 (MainThread): Tracking: tracking
2019-05-23 16:04:55,581 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111119e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111119a90>]}
2019-05-23 16:04:55,763 (MainThread): Parsing macros/core.sql
2019-05-23 16:04:55,769 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 16:04:55,777 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 16:04:55,791 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 16:04:55,801 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 16:04:55,821 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 16:04:55,824 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 16:04:55,831 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 16:04:55,837 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 16:04:55,843 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 16:04:55,844 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 16:04:55,851 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 16:04:55,853 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 16:04:55,877 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 16:04:55,879 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 16:04:55,880 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 16:04:55,881 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 16:04:55,883 (MainThread): Parsing macros/catalog.sql
2019-05-23 16:04:55,885 (MainThread): Parsing macros/adapters.sql
2019-05-23 16:04:55,892 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 16:04:55,893 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 16:04:55,893 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 16:04:55,909 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-23 16:04:55,918 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-23 16:04:55,921 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-23 16:04:55,924 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-23 16:04:55,942 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-23 16:04:55,942 (MainThread): 
2019-05-23 16:04:55,954 (MainThread): Parsing macros/core.sql
2019-05-23 16:04:55,958 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-23 16:04:55,964 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-23 16:04:55,978 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-23 16:04:55,987 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-23 16:04:56,007 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-23 16:04:56,011 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-23 16:04:56,018 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-23 16:04:56,023 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-23 16:04:56,029 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-23 16:04:56,030 (MainThread): Parsing macros/etc/datetime.sql
2019-05-23 16:04:56,037 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-23 16:04:56,039 (MainThread): Parsing macros/adapters/common.sql
2019-05-23 16:04:56,063 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-23 16:04:56,064 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-23 16:04:56,065 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-23 16:04:56,066 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-23 16:04:56,068 (MainThread): Parsing macros/catalog.sql
2019-05-23 16:04:56,070 (MainThread): Parsing macros/adapters.sql
2019-05-23 16:04:56,076 (MainThread): Parsing macros/materializations/merge.sql
2019-05-23 16:04:56,077 (MainThread): Parsing macros/materializations/view.sql
2019-05-23 16:04:56,078 (MainThread): Parsing macros/materializations/table.sql
2019-05-23 16:04:56,162 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-23 16:04:56,162 (MainThread): Opening a new connection, currently in state init
2019-05-23 16:04:56,530 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-05-23 16:04:56,544 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-05-23 16:04:56,941 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-23 16:04:56,941 (MainThread): On list_relations_without_caching: BEGIN
2019-05-23 16:04:57,105 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-23 16:04:57,105 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-23 16:04:57,105 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-23 16:05:09,109 (MainThread): SQL status: SUCCESS 59 in 12.00 seconds
2019-05-23 16:05:09,122 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-23 16:05:10,427 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-23 16:05:10,427 (MainThread): Re-using an available connection from the pool.
2019-05-23 16:05:10,427 (MainThread): Using snowflake connection "list_schemas".
2019-05-23 16:05:10,427 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name ilike 'SB_HACKATHON_DB_TEAM1'
2019-05-23 16:05:21,933 (MainThread): SQL status: SUCCESS 2 in 11.51 seconds
2019-05-23 16:05:21,934 (MainThread): 16:05:21 | Concurrency: 1 threads (target='dev')
2019-05-23 16:05:21,934 (MainThread): 16:05:21 | 
2019-05-23 16:05:21,935 (Thread-1): 16:05:21 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-23 16:05:21,936 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-23 16:05:21,939 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-23 16:05:21,967 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-23 16:05:21,968 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-23 16:05:21,968 (Thread-1): Re-using an available connection from the pool.
2019-05-23 16:05:21,968 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-23 16:05:21,968 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-23 16:05:22,177 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2019-05-23 16:05:22,178 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-23 16:05:22,178 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model
--adding comments to test git integration



select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-23 16:05:23,591 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2019-05-23 16:05:23,593 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-23 16:05:23,593 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-23 16:05:23,593 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-23 16:05:23,737 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-23 16:05:23,743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ac9280-e22a-4049-95cf-5a54c754ddab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11394e3c8>]}
2019-05-23 16:05:23,834 (Thread-1): 16:05:23 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 1.81s]
2019-05-23 16:05:23,834 (Thread-1): 16:05:23 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-23 16:05:23,836 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-23 16:05:23,841 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-23 16:05:23,846 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-23 16:05:23,846 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-23 16:05:23,846 (Thread-1): Re-using an available connection from the pool.
2019-05-23 16:05:23,847 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-23 16:05:23,847 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-23 16:05:24,008 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2019-05-23 16:05:24,008 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-23 16:05:24,008 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-23 16:05:24,676 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2019-05-23 16:05:24,678 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-23 16:05:24,678 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-23 16:05:24,678 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-23 16:05:24,812 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2019-05-23 16:05:24,817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ac9280-e22a-4049-95cf-5a54c754ddab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11394eb70>]}
2019-05-23 16:05:24,902 (Thread-1): 16:05:24 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.98s]
2019-05-23 16:05:24,902 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-23 16:05:24,907 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-23 16:05:24,911 (Thread-1): 16:05:24 | 3 of 3 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-23 16:05:24,911 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-23 16:05:24,922 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-23 16:05:24,926 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-23 16:05:24,927 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-23 16:05:24,927 (Thread-1): Re-using an available connection from the pool.
2019-05-23 16:05:24,928 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-23 16:05:24,928 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-23 16:05:25,109 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-23 16:05:25,109 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-23 16:05:25,109 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date



with  __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
),SPOTIFY_STOCK_DATA as 
(
    select * from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data
),

SPOTIFY_STOCK_DATE as
(
    select * from __dbt__CTE__xf_spotify_date
)

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
    , avg(Open) as "Open"
    , avg(Close) as "Close"
from SPOTIFY_STOCK_DATE DT  left join SPOTIFY_STOCK_DATA DTA on DT.Date_Added = DTA."Date"
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-23 16:05:26,105 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2019-05-23 16:05:26,107 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-23 16:05:26,107 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-23 16:05:26,107 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-23 16:05:26,253 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-23 16:05:26,259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ac9280-e22a-4049-95cf-5a54c754ddab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139379e8>]}
2019-05-23 16:05:26,353 (Thread-1): 16:05:26 | 3 of 3 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 1.35s]
2019-05-23 16:05:26,440 (MainThread): 16:05:26 | 
2019-05-23 16:05:26,440 (MainThread): 16:05:26 | Finished running 3 view models in 30.50s.
2019-05-23 16:05:26,682 (MainThread): 
2019-05-23 16:05:26,682 (MainThread): Completed successfully
2019-05-23 16:05:26,682 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-05-23 16:05:26,682 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113657b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113657908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de8240>]}
2019-05-23 16:05:26,768 (MainThread): Flushing usage events

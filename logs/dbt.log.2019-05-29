2019-05-29 09:36:24,245 (MainThread): Tracking: tracking
2019-05-29 09:36:24,258 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5680b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5682e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a568128>]}
2019-05-29 09:36:24,436 (MainThread): Checking target/*
2019-05-29 09:36:24,439 (MainThread):  Cleaned target/*
2019-05-29 09:36:24,439 (MainThread): Checking dbt_modules/*
2019-05-29 09:36:24,439 (MainThread):  Cleaned dbt_modules/*
2019-05-29 09:36:24,439 (MainThread): Finished cleaning all paths.
2019-05-29 09:36:24,439 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072564a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3a7b8>]}
2019-05-29 09:36:24,530 (MainThread): Flushing usage events
2019-05-29 09:36:30,866 (MainThread): Tracking: tracking
2019-05-29 09:36:30,866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a925400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9255c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ce4a8>]}
2019-05-29 09:36:30,976 (MainThread): Parsing macros/core.sql
2019-05-29 09:36:30,982 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-29 09:36:30,989 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-29 09:36:31,003 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-29 09:36:31,015 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-29 09:36:31,034 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-29 09:36:31,038 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-29 09:36:31,045 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-29 09:36:31,050 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-29 09:36:31,056 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-29 09:36:31,058 (MainThread): Parsing macros/etc/datetime.sql
2019-05-29 09:36:31,064 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-29 09:36:31,067 (MainThread): Parsing macros/adapters/common.sql
2019-05-29 09:36:31,090 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-29 09:36:31,091 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-29 09:36:31,093 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-29 09:36:31,094 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-29 09:36:31,096 (MainThread): Parsing macros/catalog.sql
2019-05-29 09:36:31,098 (MainThread): Parsing macros/adapters.sql
2019-05-29 09:36:31,104 (MainThread): Parsing macros/materializations/merge.sql
2019-05-29 09:36:31,105 (MainThread): Parsing macros/materializations/view.sql
2019-05-29 09:36:31,106 (MainThread): Parsing macros/materializations/table.sql
2019-05-29 09:36:31,122 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-29 09:36:31,131 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-29 09:36:31,135 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-29 09:36:31,138 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-29 09:36:31,156 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-29 09:36:31,156 (MainThread): 
2019-05-29 09:36:31,156 (MainThread): 09:36:31 | Concurrency: 1 threads (target='dev')
2019-05-29 09:36:31,156 (MainThread): 09:36:31 | 
2019-05-29 09:36:31,157 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-29 09:36:31,161 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-29 09:36:31,163 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-29 09:36:31,166 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-29 09:36:31,168 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-29 09:36:31,171 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-29 09:36:31,174 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-29 09:36:31,183 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-29 09:36:31,269 (MainThread): 09:36:31 | Done.
2019-05-29 09:36:31,269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb6cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb6128>]}
2019-05-29 09:36:31,365 (MainThread): Flushing usage events
2019-05-29 09:36:35,598 (MainThread): Tracking: tracking
2019-05-29 09:36:35,598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147539b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114753dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114753e10>]}
2019-05-29 09:36:35,710 (MainThread): Parsing macros/core.sql
2019-05-29 09:36:35,715 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-29 09:36:35,721 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-29 09:36:35,735 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-29 09:36:35,743 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-29 09:36:35,762 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-29 09:36:35,765 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-29 09:36:35,772 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-29 09:36:35,778 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-29 09:36:35,783 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-29 09:36:35,784 (MainThread): Parsing macros/etc/datetime.sql
2019-05-29 09:36:35,790 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-29 09:36:35,792 (MainThread): Parsing macros/adapters/common.sql
2019-05-29 09:36:35,815 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-29 09:36:35,816 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-29 09:36:35,817 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-29 09:36:35,818 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-29 09:36:35,820 (MainThread): Parsing macros/catalog.sql
2019-05-29 09:36:35,822 (MainThread): Parsing macros/adapters.sql
2019-05-29 09:36:35,828 (MainThread): Parsing macros/materializations/merge.sql
2019-05-29 09:36:35,829 (MainThread): Parsing macros/materializations/view.sql
2019-05-29 09:36:35,829 (MainThread): Parsing macros/materializations/table.sql
2019-05-29 09:36:35,844 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-29 09:36:35,852 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-29 09:36:35,855 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-29 09:36:35,858 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-29 09:36:35,874 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-29 09:36:35,875 (MainThread): 
2019-05-29 09:36:35,886 (MainThread): Parsing macros/core.sql
2019-05-29 09:36:35,889 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-29 09:36:35,895 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-29 09:36:35,906 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-29 09:36:35,914 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-29 09:36:35,931 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-29 09:36:35,935 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-29 09:36:35,942 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-29 09:36:35,947 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-29 09:36:35,953 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-29 09:36:35,954 (MainThread): Parsing macros/etc/datetime.sql
2019-05-29 09:36:35,960 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-29 09:36:35,962 (MainThread): Parsing macros/adapters/common.sql
2019-05-29 09:36:35,985 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-29 09:36:35,986 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-29 09:36:35,987 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-29 09:36:35,989 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-29 09:36:35,990 (MainThread): Parsing macros/catalog.sql
2019-05-29 09:36:35,992 (MainThread): Parsing macros/adapters.sql
2019-05-29 09:36:35,998 (MainThread): Parsing macros/materializations/merge.sql
2019-05-29 09:36:35,999 (MainThread): Parsing macros/materializations/view.sql
2019-05-29 09:36:36,000 (MainThread): Parsing macros/materializations/table.sql
2019-05-29 09:36:36,080 (MainThread): Acquiring new snowflake connection "list_relations_without_caching".
2019-05-29 09:36:36,080 (MainThread): Opening a new connection, currently in state init
2019-05-29 09:36:36,469 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-05-29 09:36:36,487 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-05-29 09:36:37,037 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-29 09:36:37,037 (MainThread): On list_relations_without_caching: BEGIN
2019-05-29 09:36:37,222 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-29 09:36:37,222 (MainThread): Using snowflake connection "list_relations_without_caching".
2019-05-29 09:36:37,222 (MainThread): On list_relations_without_caching: select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           when table_type = 'MATERIALIZED VIEW' then 'materializedview'
           else table_type
      end as table_type
    from SB_HACKATHON_DB_TEAM1.information_schema.tables
    where table_schema ilike 'gdelt_raw'
      and table_catalog ilike 'sb_hackathon_db_team1'
2019-05-29 09:36:48,268 (MainThread): SQL status: SUCCESS 56 in 11.05 seconds
2019-05-29 09:36:48,281 (MainThread): On list_relations_without_caching: ROLLBACK
2019-05-29 09:36:48,552 (MainThread): Acquiring new snowflake connection "list_schemas".
2019-05-29 09:36:48,552 (MainThread): Re-using an available connection from the pool.
2019-05-29 09:36:48,552 (MainThread): Using snowflake connection "list_schemas".
2019-05-29 09:36:48,553 (MainThread): On list_schemas: select distinct schema_name
    from SB_HACKATHON_DB_TEAM1.information_schema.schemata
    where catalog_name ilike 'SB_HACKATHON_DB_TEAM1'
2019-05-29 09:36:49,923 (MainThread): SQL status: SUCCESS 2 in 1.37 seconds
2019-05-29 09:36:49,924 (MainThread): 09:36:49 | Concurrency: 1 threads (target='dev')
2019-05-29 09:36:49,924 (MainThread): 09:36:49 | 
2019-05-29 09:36:49,926 (Thread-1): 09:36:49 | 1 of 3 START view model GDELT_RAW.base_spotify_in_url................ [RUN]
2019-05-29 09:36:49,926 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-29 09:36:49,930 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-29 09:36:49,961 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_in_url"
2019-05-29 09:36:49,962 (Thread-1): Acquiring new snowflake connection "base_spotify_in_url".
2019-05-29 09:36:49,962 (Thread-1): Re-using an available connection from the pool.
2019-05-29 09:36:49,962 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-29 09:36:49,962 (Thread-1): On base_spotify_in_url: BEGIN
2019-05-29 09:36:50,129 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-29 09:36:50,130 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-29 09:36:50,130 (Thread-1): On base_spotify_in_url: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url as (
    --Spotify directly referenced in Source URLs; base model
--adding comments to test git integration



select * 
from GLOBAL_EVENT_V2
where lower(SOURCEURL) like '%spotify%'
  );
2019-05-29 09:36:50,883 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2019-05-29 09:36:50,885 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-29 09:36:50,885 (Thread-1): Using snowflake connection "base_spotify_in_url".
2019-05-29 09:36:50,885 (Thread-1): On base_spotify_in_url: COMMIT
2019-05-29 09:36:51,052 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2019-05-29 09:36:51,057 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4c65c5-9e02-44b1-9910-822541d266cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e7b9b0>]}
2019-05-29 09:36:51,146 (Thread-1): 09:36:51 | 1 of 3 OK created view model GDELT_RAW.base_spotify_in_url........... [SUCCESS 1 in 1.13s]
2019-05-29 09:36:51,146 (Thread-1): 09:36:51 | 2 of 3 START view model GDELT_RAW.base_spotify_stock_data............ [RUN]
2019-05-29 09:36:51,147 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-29 09:36:51,152 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-29 09:36:51,156 (Thread-1): Writing runtime SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-29 09:36:51,156 (Thread-1): Acquiring new snowflake connection "base_spotify_stock_data".
2019-05-29 09:36:51,157 (Thread-1): Re-using an available connection from the pool.
2019-05-29 09:36:51,157 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-29 09:36:51,157 (Thread-1): On base_spotify_stock_data: BEGIN
2019-05-29 09:36:51,350 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2019-05-29 09:36:51,351 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-29 09:36:51,351 (Thread-1): On base_spotify_stock_data: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data as (
    -- Welcome to your first dbt model!
-- Did you know that you can also configure models directly within
-- the SQL file? This will override configurations stated in dbt_project.yml

-- Try changing 'view' to 'table', then re-running dbt



select * from SPOTIFY_STOCK_DATA
  );
2019-05-29 09:36:51,760 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2019-05-29 09:36:51,761 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-29 09:36:51,761 (Thread-1): Using snowflake connection "base_spotify_stock_data".
2019-05-29 09:36:51,761 (Thread-1): On base_spotify_stock_data: COMMIT
2019-05-29 09:36:51,898 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-29 09:36:51,901 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4c65c5-9e02-44b1-9910-822541d266cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f5a1d0>]}
2019-05-29 09:36:51,980 (Thread-1): 09:36:51 | 2 of 3 OK created view model GDELT_RAW.base_spotify_stock_data....... [SUCCESS 1 in 0.75s]
2019-05-29 09:36:51,980 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-29 09:36:51,984 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-29 09:36:51,986 (Thread-1): 09:36:51 | 3 of 3 START view model GDELT_RAW.xf_spotify_aggregated.............. [RUN]
2019-05-29 09:36:51,986 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-29 09:36:51,996 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-29 09:36:51,999 (Thread-1): Writing runtime SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-29 09:36:51,999 (Thread-1): Acquiring new snowflake connection "xf_spotify_aggregated".
2019-05-29 09:36:52,000 (Thread-1): Re-using an available connection from the pool.
2019-05-29 09:36:52,001 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-29 09:36:52,001 (Thread-1): On xf_spotify_aggregated: BEGIN
2019-05-29 09:36:52,181 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2019-05-29 09:36:52,182 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-29 09:36:52,182 (Thread-1): On xf_spotify_aggregated: create or replace view SB_HACKATHON_DB_TEAM1.GDELT_RAW.xf_spotify_aggregated as (
    --aggregating xf_spotify_date



with  __dbt__CTE__xf_spotify_date as (
--Reformatting dates; xf

-- configuring this model as ephemeral so that it doesn't get materialized in the db



select 
      to_timestamp_ntz(cast(DATEADDED as string), 'YYYYMMDD HH24MISS') as Date_Added
    , GoldsteinScale
    , NumArticles
    , AvgTone
    , 'Spotify Mention' as Spotify
    , SourceURL
from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_in_url --using ref() functions, dbt understands dependencies between models and creates DAGs in  proper order 
where NumArticles is not null and NumMentions is not null and AvgTone is not null
order by dateadded asc
),SPOTIFY_STOCK_DATA as 
(
    select * from SB_HACKATHON_DB_TEAM1.GDELT_RAW.base_spotify_stock_data
),

SPOTIFY_STOCK_DATE as
(
    select * from __dbt__CTE__xf_spotify_date
)

select 
      Date_Added
    , Spotify
    , avg(GoldsteinScale) as Avg_GoldensteinScale
    , avg(NumArticles) as Avg_Articles
    , avg(AvgTone) as Avg_Tone
    , avg(Open) as "Open"
    , avg(Close) as "Close"
from SPOTIFY_STOCK_DATE DT  left join SPOTIFY_STOCK_DATA DTA on DT.Date_Added = DTA."Date"
group by Date_Added, Spotify 
order by Date_added asc
  );
2019-05-29 09:36:53,046 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2019-05-29 09:36:53,047 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-29 09:36:53,047 (Thread-1): Using snowflake connection "xf_spotify_aggregated".
2019-05-29 09:36:53,047 (Thread-1): On xf_spotify_aggregated: COMMIT
2019-05-29 09:36:53,188 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2019-05-29 09:36:53,193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee4c65c5-9e02-44b1-9910-822541d266cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dfcf28>]}
2019-05-29 09:36:53,287 (Thread-1): 09:36:53 | 3 of 3 OK created view model GDELT_RAW.xf_spotify_aggregated......... [SUCCESS 1 in 1.21s]
2019-05-29 09:36:53,387 (MainThread): 09:36:53 | 
2019-05-29 09:36:53,387 (MainThread): 09:36:53 | Finished running 3 view models in 17.51s.
2019-05-29 09:36:53,671 (MainThread): 
2019-05-29 09:36:53,671 (MainThread): Completed successfully
2019-05-29 09:36:53,671 (MainThread): 
Done. PASS=3 ERROR=0 SKIP=0 TOTAL=3
2019-05-29 09:36:53,671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c45048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c45358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c457f0>]}
2019-05-29 09:36:53,760 (MainThread): Flushing usage events
2019-05-29 09:37:48,872 (MainThread): Tracking: tracking
2019-05-29 09:37:48,873 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e1320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558b4a8>]}
2019-05-29 09:37:49,044 (MainThread): Parsing macros/core.sql
2019-05-29 09:37:49,049 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-29 09:37:49,055 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-29 09:37:49,069 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-29 09:37:49,077 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-29 09:37:49,095 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-29 09:37:49,099 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-29 09:37:49,105 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-29 09:37:49,111 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-29 09:37:49,116 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-29 09:37:49,118 (MainThread): Parsing macros/etc/datetime.sql
2019-05-29 09:37:49,124 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-29 09:37:49,126 (MainThread): Parsing macros/adapters/common.sql
2019-05-29 09:37:49,149 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-29 09:37:49,150 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-29 09:37:49,151 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-29 09:37:49,152 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-29 09:37:49,154 (MainThread): Parsing macros/catalog.sql
2019-05-29 09:37:49,156 (MainThread): Parsing macros/adapters.sql
2019-05-29 09:37:49,162 (MainThread): Parsing macros/materializations/merge.sql
2019-05-29 09:37:49,163 (MainThread): Parsing macros/materializations/view.sql
2019-05-29 09:37:49,163 (MainThread): Parsing macros/materializations/table.sql
2019-05-29 09:37:49,178 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-29 09:37:49,185 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-29 09:37:49,189 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-29 09:37:49,191 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-29 09:37:49,208 (MainThread): Found 4 models, 0 tests, 0 archives, 0 analyses, 95 macros, 0 operations, 0 seed files, 0 sources
2019-05-29 09:37:49,209 (MainThread): 
2019-05-29 09:37:49,209 (MainThread): 09:37:49 | Concurrency: 1 threads (target='dev')
2019-05-29 09:37:49,209 (MainThread): 09:37:49 | 
2019-05-29 09:37:49,210 (Thread-1): Compiling model.gdelt.base_spotify_in_url
2019-05-29 09:37:49,213 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_in_url"
2019-05-29 09:37:49,214 (Thread-1): Compiling model.gdelt.base_spotify_stock_data
2019-05-29 09:37:49,217 (Thread-1): Writing injected SQL for node "model.gdelt.base_spotify_stock_data"
2019-05-29 09:37:49,220 (Thread-1): Compiling model.gdelt.xf_spotify_date
2019-05-29 09:37:49,223 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_date"
2019-05-29 09:37:49,225 (Thread-1): Compiling model.gdelt.xf_spotify_aggregated
2019-05-29 09:37:49,234 (Thread-1): Writing injected SQL for node "model.gdelt.xf_spotify_aggregated"
2019-05-29 09:37:49,316 (MainThread): 09:37:49 | Done.
2019-05-29 09:37:49,334 (MainThread): Parsing macros/core.sql
2019-05-29 09:37:49,338 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-29 09:37:49,345 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-29 09:37:49,359 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-29 09:37:49,367 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-29 09:37:49,386 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-29 09:37:49,389 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-29 09:37:49,396 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-29 09:37:49,401 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-29 09:37:49,407 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-29 09:37:49,408 (MainThread): Parsing macros/etc/datetime.sql
2019-05-29 09:37:49,414 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-29 09:37:49,416 (MainThread): Parsing macros/adapters/common.sql
2019-05-29 09:37:49,440 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-29 09:37:49,441 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-29 09:37:49,442 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-29 09:37:49,443 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-29 09:37:49,445 (MainThread): Parsing macros/catalog.sql
2019-05-29 09:37:49,447 (MainThread): Parsing macros/adapters.sql
2019-05-29 09:37:49,453 (MainThread): Parsing macros/materializations/merge.sql
2019-05-29 09:37:49,454 (MainThread): Parsing macros/materializations/view.sql
2019-05-29 09:37:49,454 (MainThread): Parsing macros/materializations/table.sql
2019-05-29 09:37:49,468 (MainThread): Parsing model.gdelt.xf_spotify_aggregated
2019-05-29 09:37:49,473 (MainThread): Parsing model.gdelt.xf_spotify_date
2019-05-29 09:37:49,476 (MainThread): Parsing model.gdelt.base_spotify_in_url
2019-05-29 09:37:49,479 (MainThread): Parsing model.gdelt.base_spotify_stock_data
2019-05-29 09:37:49,490 (MainThread): 09:37:49 | Building catalog
2019-05-29 09:37:49,501 (MainThread): Parsing macros/core.sql
2019-05-29 09:37:49,504 (MainThread): Parsing macros/materializations/helpers.sql
2019-05-29 09:37:49,509 (MainThread): Parsing macros/materializations/seed/seed.sql
2019-05-29 09:37:49,521 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2019-05-29 09:37:49,529 (MainThread): Parsing macros/materializations/archive/archive.sql
2019-05-29 09:37:49,546 (MainThread): Parsing macros/materializations/common/merge.sql
2019-05-29 09:37:49,549 (MainThread): Parsing macros/materializations/table/table.sql
2019-05-29 09:37:49,556 (MainThread): Parsing macros/materializations/view/view.sql
2019-05-29 09:37:49,561 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2019-05-29 09:37:49,566 (MainThread): Parsing macros/etc/is_incremental.sql
2019-05-29 09:37:49,568 (MainThread): Parsing macros/etc/datetime.sql
2019-05-29 09:37:49,574 (MainThread): Parsing macros/etc/get_custom_schema.sql
2019-05-29 09:37:49,576 (MainThread): Parsing macros/adapters/common.sql
2019-05-29 09:37:49,599 (MainThread): Parsing macros/schema_tests/relationships.sql
2019-05-29 09:37:49,600 (MainThread): Parsing macros/schema_tests/not_null.sql
2019-05-29 09:37:49,601 (MainThread): Parsing macros/schema_tests/unique.sql
2019-05-29 09:37:49,602 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2019-05-29 09:37:49,603 (MainThread): Parsing macros/catalog.sql
2019-05-29 09:37:49,605 (MainThread): Parsing macros/adapters.sql
2019-05-29 09:37:49,612 (MainThread): Parsing macros/materializations/merge.sql
2019-05-29 09:37:49,613 (MainThread): Parsing macros/materializations/view.sql
2019-05-29 09:37:49,613 (MainThread): Parsing macros/materializations/table.sql
2019-05-29 09:37:49,687 (MainThread): Acquiring new snowflake connection "get_catalog".
2019-05-29 09:37:49,687 (MainThread): Opening a new connection, currently in state init
2019-05-29 09:37:50,019 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/botocore/vendored/requests/cacert.pem'>

2019-05-29 09:37:50,032 (MainThread): /anaconda3/lib/python3.6/site-packages/snowflake/connector/ocsp_asn1crypto.py:83: ResourceWarning: unclosed file <_io.BufferedReader name='/anaconda3/lib/python3.6/site-packages/certifi/cacert.pem'>

2019-05-29 09:37:50,561 (MainThread): Using snowflake connection "get_catalog".
2019-05-29 09:37:50,562 (MainThread): On get_catalog: BEGIN
2019-05-29 09:37:50,712 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2019-05-29 09:37:50,712 (MainThread): Using snowflake connection "get_catalog".
2019-05-29 09:37:50,712 (MainThread): On get_catalog: (
            with tables as (

                select
                    table_catalog as "table_database",
                    table_schema as "table_schema",
                    table_name as "table_name",
                    table_type as "table_type",

                    -- note: this is the _role_ that owns the table
                    table_owner as "table_owner",

                    'Clustering Key' as "stats:clustering_key:label",
                    clustering_key as "stats:clustering_key:value",
                    'The key used to cluster this table' as "stats:clustering_key:description",
                    (clustering_key is not null) as "stats:clustering_key:include",

                    'Row Count' as "stats:row_count:label",
                    row_count as "stats:row_count:value",
                    'An approximate count of rows in this table' as "stats:row_count:description",
                    (row_count is not null) as "stats:row_count:include",

                    'Approximate Size' as "stats:bytes:label",
                    bytes as "stats:bytes:value",
                    'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
                    (bytes is not null) as "stats:bytes:include"

                from SB_HACKATHON_DB_TEAM1.information_schema.tables

            ),

            columns as (

                select
                    table_catalog as "table_database",
                    table_schema as "table_schema",
                    table_name as "table_name",
                    null as "table_comment",

                    column_name as "column_name",
                    ordinal_position as "column_index",
                    data_type as "column_type",
                    null as "column_comment"

                from SB_HACKATHON_DB_TEAM1.information_schema.columns

            )

            select *
            from tables
            join columns using ("table_database", "table_schema", "table_name")
            where "table_schema" != 'INFORMATION_SCHEMA'
            order by "column_index"
        )
2019-05-29 09:38:02,957 (MainThread): SQL status: SUCCESS 838 in 12.25 seconds
2019-05-29 09:38:03,566 (MainThread): On get_catalog: ROLLBACK
2019-05-29 09:38:03,797 (MainThread): 09:38:03 | Catalog written to /Users/vannatrieu/Documents/git_repos/gdelt/target/catalog.json
2019-05-29 09:38:03,798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1320>]}
2019-05-29 09:38:03,890 (MainThread): Flushing usage events
2019-05-29 09:38:10,431 (MainThread): Tracking: tracking
2019-05-29 09:38:10,432 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa0d47ae48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa0d47acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6af5c0>]}
2019-05-29 09:38:10,618 (MainThread): Serving docs at 0.0.0.0:8080
2019-05-29 09:38:10,618 (MainThread): To access from your browser, navigate to http://localhost:8080.
2019-05-29 09:38:10,618 (MainThread): Press Ctrl+C to exit.


2019-05-29 09:39:02,460 (MainThread): Flushing usage events
2019-05-29 09:39:02,461 (MainThread): ctrl-c
2019-05-29 15:22:32,481 (MainThread): Tracking: tracking
2019-05-29 15:22:32,490 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95ccc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95c358>]}
2019-05-29 15:22:32,640 (MainThread): Checking target/*
2019-05-29 15:22:32,643 (MainThread):  Cleaned target/*
2019-05-29 15:22:32,643 (MainThread): Checking dbt_modules/*
2019-05-29 15:22:32,643 (MainThread):  Cleaned dbt_modules/*
2019-05-29 15:22:32,643 (MainThread): Finished cleaning all paths.
2019-05-29 15:22:32,643 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3d828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c142518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ea9b0>]}
2019-05-29 15:22:32,736 (MainThread): Flushing usage events
